[
  {
    "id": 0,
    "author": "user",
    "payload": {
      "type": "text",
      "text": "You are a 10 years experienced Full stack developer unserstand my requirement and make the app if needed improvise\n i run an office where i work on professional tax,trade license,pan card and income tax in future we will be working on  other things also so i want an Software where there will be two panel one for admin and another for the employees \nAdmin can :-\nadd employees,edit employees and delete employees\ncreate,edit or delete work type and that particular works table structure like date,name of customer,expiry date etc\nadmin will make the layout for the work page for the employees and then it will be registered in database (for now local storage) \nEmployees can :- \nfill the fields created by admin in work page\nand also get notification in the dashboard split by workpage based on the epiry date or the last filled date or based on field marked by admin\nemployees username and password created by admin and admin username and password will be admin and admin stored in database permanently (for now local storage)\n",
      "files": [],
      "fileUploads": [],
      "cMarkNode": {}
    },
    "createdTimestamp": {
      "seconds": 1771080966,
      "nanos": 479000000
    }
  },
  {
    "id": 1,
    "author": "model",
    "payload": {
      "type": "thinking",
      "text": "**Defining Software Scope**\n\nI'm currently focused on defining the initial scope for this tax and license management software. My thoughts revolve around the two user roles, Admin and Employee, and I'm actively brainstorming essential features. I'm prioritizing the Admin's capabilities, specifically employee management (create, read, update, delete) and work type management using dynamic tables. Layout design is also on the docket.\n\n\n**Refining Feature Set**\n\nI've been drilling down on the technical specifications. The layouts will leverage local storage for persistence. I've defined employee features as field completion based on admin work types, and a notification-based dashboard. Authentication will be admin/admin for now, and employee creation by the admin. The tech stack is React 18+, TypeScript, Tailwind CSS, and `localStorage`. I'm also planning a Gemini API integration. The UI will prioritize a clean, professional design with sidebar navigation and dynamic forms. I've also defined the data models.\n\n\n**Detailing System Components**\n\nI'm now focusing on the specific components. I've broken it down by role: the authentication page will be `LoginPage`. For the admin, I'm thinking of a dashboard for overview stats, employee management (CRUD), and work type management with dynamic field definition. Employees will have a dashboard for assigned work types and urgent notifications, alongside work entry forms and work history. The dynamic form builder for the admin is coming next.\n\n\n",
      "cMarkNode": {}
    },
    "createdTimestamp": {
      "seconds": 1771080966,
      "nanos": 479000000
    },
    "doneTimestamp": {
      "seconds": 1771080978,
      "nanos": 518000000
    }
  },
  {
    "id": 2,
    "author": "model",
    "payload": {
      "type": "generationTable",
      "entries": [
        {
          "path": "metadata.json",
          "generationType": 0,
          "isDone": true,
          "description": "Project metadata including name, description, and required permissions.",
          "diffs": [
            {
              "target": "",
              "replacement": "\n{\n  \"name\": \"Tax & License Office Manager\",\n  \"description\": \"A comprehensive office management software for tax professionals with dynamic form builders, employee management, and intelligent notifications for expiry dates.\",\n  \"requestFramePermissions\": []\n}\n"
            }
          ]
        },
        {
          "path": "index.html",
          "generationType": 0,
          "isDone": true,
          "description": "Main HTML entry point with Tailwind CSS and Font support.",
          "diffs": [
            {
              "target": "",
              "replacement": "\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Office Manager Pro</title>\n    <script src=\"https://cdn.tailwindcss.com\"></script>\n    <link href=\"https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap\" rel=\"stylesheet\">\n    <style>\n        body { font-family: 'Inter', sans-serif; }\n    </style>\n</head>\n<body class=\"bg-slate-50 text-slate-900\">\n    <div id=\"root\"></div>\n</body>\n</html>\n"
            }
          ]
        },
        {
          "path": "types.ts",
          "generationType": 0,
          "isDone": true,
          "description": "Global TypeScript interfaces and enums for the application.",
          "diffs": [
            {
              "target": "",
              "replacement": "\nexport enum UserRole {\n  ADMIN = 'admin',\n  EMPLOYEE = 'employee'\n}\n\nexport enum FieldType {\n  TEXT = 'text',\n  NUMBER = 'number',\n  DATE = 'date',\n  SELECT = 'select',\n  CHECKBOX = 'checkbox'\n}\n\nexport interface FieldDefinition {\n  id: string;\n  label: string;\n  type: FieldType;\n  required: boolean;\n  isExpiry: boolean; // Flag to trigger notifications\n  isPrimary: boolean; // Used for identifying records (e.g., Customer Name)\n  options?: string[]; // For select type\n}\n\nexport interface WorkType {\n  id: string;\n  name: string;\n  description: string;\n  fields: FieldDefinition[];\n  createdAt: number;\n}\n\nexport interface WorkRecord {\n  id: string;\n  workTypeId: string;\n  employeeId: string;\n  data: Record<string, any>;\n  createdAt: number;\n  lastUpdated: number;\n}\n\nexport interface User {\n  id: string;\n  username: string;\n  password: string;\n  name: string;\n  role: UserRole;\n  createdAt: number;\n}\n\nexport interface Notification {\n  id: string;\n  recordId: string;\n  workTypeName: string;\n  primaryValue: string;\n  expiryDate: string;\n  daysRemaining: number;\n  type: 'urgent' | 'warning' | 'info';\n}\n"
            }
          ]
        },
        {
          "path": "storage.ts",
          "generationType": 0,
          "isDone": true,
          "description": "Local storage persistence layer for users, work types, and records.",
          "diffs": [
            {
              "target": "",
              "replacement": "\nimport { User, UserRole, WorkType, WorkRecord } from './types';\n\nconst KEYS = {\n  USERS: 'office_users',\n  WORK_TYPES: 'office_work_types',\n  WORK_RECORDS: 'office_work_records'\n};\n\nconst INITIAL_ADMIN: User = {\n  id: 'admin-0',\n  username: 'admin',\n  password: 'admin',\n  name: 'System Admin',\n  role: UserRole.ADMIN,\n  createdAt: Date.now()\n};\n\nexport const Storage = {\n  getUsers: (): User[] => {\n    const data = localStorage.getItem(KEYS.USERS);\n    if (!data) return [INITIAL_ADMIN];\n    return JSON.parse(data);\n  },\n  saveUsers: (users: User[]) => {\n    localStorage.setItem(KEYS.USERS, JSON.stringify(users));\n  },\n  \n  getWorkTypes: (): WorkType[] => {\n    const data = localStorage.getItem(KEYS.WORK_TYPES);\n    return data ? JSON.parse(data) : [];\n  },\n  saveWorkTypes: (types: WorkType[]) => {\n    localStorage.setItem(KEYS.WORK_TYPES, JSON.stringify(types));\n  },\n\n  getWorkRecords: (): WorkRecord[] => {\n    const data = localStorage.getItem(KEYS.WORK_RECORDS);\n    return data ? JSON.parse(data) : [];\n  },\n  saveWorkRecords: (records: WorkRecord[]) => {\n    localStorage.setItem(KEYS.WORK_RECORDS, JSON.stringify(records));\n  }\n};\n"
            }
          ]
        },
        {
          "path": "geminiService.ts",
          "generationType": 0,
          "isDone": true,
          "description": "Gemini API service for AI-powered suggestions during form building.",
          "diffs": [
            {
              "target": "",
              "replacement": "\nimport { GoogleGenAI, Type } from \"@google/genai\";\n\nconst ai = new GoogleGenAI({ apiKey: process.env.API_KEY });\n\nexport async function suggestFieldsForWorkType(workTypeName: string) {\n  try {\n    const response = await ai.models.generateContent({\n      model: \"gemini-3-flash-preview\",\n      contents: `I am building a database table for a professional office task called \"${workTypeName}\". \n      Suggest a JSON list of 5-8 essential fields needed for this.\n      Focus on things like Customer Name, ID numbers (PAN, GSTIN), Dates (Issue Date, Expiry Date), and Status.\n      Mark one as 'isPrimary' (true for things like Customer Name) and one as 'isExpiry' (true for deadline dates).`,\n      config: {\n        responseMimeType: \"application/json\",\n        responseSchema: {\n          type: Type.ARRAY,\n          items: {\n            type: Type.OBJECT,\n            properties: {\n              label: { type: Type.STRING },\n              type: { type: Type.STRING, enum: ['text', 'number', 'date', 'select'] },\n              required: { type: Type.BOOLEAN },\n              isExpiry: { type: Type.BOOLEAN },\n              isPrimary: { type: Type.BOOLEAN }\n            },\n            required: ['label', 'type', 'required', 'isExpiry', 'isPrimary']\n          }\n        }\n      }\n    });\n\n    return JSON.parse(response.text);\n  } catch (error) {\n    console.error(\"Gemini Suggestion Error:\", error);\n    return [];\n  }\n}\n"
            }
          ]
        },
        {
          "path": "components/Layout.tsx",
          "generationType": 0,
          "isDone": true,
          "description": "Main layout wrapper with navigation sidebar.",
          "diffs": [
            {
              "target": "",
              "replacement": "\nimport React from 'react';\nimport { User, UserRole } from '../types';\n\ninterface LayoutProps {\n  user: User;\n  onLogout: () => void;\n  children: React.ReactNode;\n  activeTab: string;\n  setActiveTab: (tab: string) => void;\n}\n\nconst Layout: React.FC<LayoutProps> = ({ user, onLogout, children, activeTab, setActiveTab }) => {\n  const isAdmin = user.role === UserRole.ADMIN;\n\n  const menuItems = isAdmin \n    ? [\n        { id: 'dashboard', label: 'Dashboard', icon: 'üìä' },\n        { id: 'employees', label: 'Manage Employees', icon: 'üë•' },\n        { id: 'work-types', label: 'Setup Work Pages', icon: 'üõ†Ô∏è' },\n        { id: 'all-records', label: 'Office Records', icon: 'üìÅ' },\n      ]\n    : [\n        { id: 'dashboard', label: 'My Dashboard', icon: 'üè†' },\n        { id: 'work-entry', label: 'New Work Entry', icon: '‚úçÔ∏è' },\n        { id: 'my-records', label: 'My Submissions', icon: 'üìã' },\n      ];\n\n  return (\n    <div className=\"flex h-screen overflow-hidden bg-slate-50\">\n      {/* Sidebar */}\n      <aside className=\"w-64 bg-slate-900 text-white flex flex-col\">\n        <div className=\"p-6 border-b border-slate-800\">\n          <h1 className=\"text-xl font-bold tracking-tight text-indigo-400\">OfficeHub Pro</h1>\n          <p className=\"text-xs text-slate-400 mt-1 uppercase tracking-widest\">{user.role}</p>\n        </div>\n        \n        <nav className=\"flex-1 p-4 space-y-1\">\n          {menuItems.map((item) => (\n            <button\n              key={item.id}\n              onClick={() => setActiveTab(item.id)}\n              className={`w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors ${\n                activeTab === item.id \n                  ? 'bg-indigo-600 text-white shadow-lg' \n                  : 'text-slate-400 hover:bg-slate-800 hover:text-white'\n              }`}\n            >\n              <span className=\"text-xl\">{item.icon}</span>\n              <span className=\"font-medium\">{item.label}</span>\n            </button>\n          ))}\n        </nav>\n\n        <div className=\"p-4 border-t border-slate-800\">\n          <div className=\"flex items-center space-x-3 px-4 py-2 mb-4\">\n            <div className=\"w-8 h-8 rounded-full bg-indigo-500 flex items-center justify-center text-xs font-bold\">\n              {user.name.charAt(0)}\n            </div>\n            <div className=\"flex-1 overflow-hidden\">\n              <p className=\"text-sm font-medium truncate\">{user.name}</p>\n              <p className=\"text-xs text-slate-500 truncate\">{user.username}</p>\n            </div>\n          </div>\n          <button\n            onClick={onLogout}\n            className=\"w-full flex items-center justify-center space-x-2 px-4 py-2 rounded-lg bg-slate-800 hover:bg-red-900/50 hover:text-red-200 transition-all text-slate-300\"\n          >\n            <span>üö™</span>\n            <span className=\"text-sm font-semibold\">Logout</span>\n          </button>\n        </div>\n      </aside>\n\n      {/* Main Content */}\n      <main className=\"flex-1 overflow-y-auto p-8 relative\">\n        <div className=\"max-w-6xl mx-auto\">\n          {children}\n        </div>\n      </main>\n    </div>\n  );\n};\n\nexport default Layout;\n"
            }
          ]
        },
        {
          "path": "components/AdminDashboard.tsx",
          "generationType": 0,
          "isDone": true,
          "description": "Overview for administrators with stats and notifications.",
          "diffs": [
            {
              "target": "",
              "replacement": "\nimport React from 'react';\nimport { User, WorkType, WorkRecord, Notification } from '../types';\nimport { differenceInDays, parseISO } from 'date-fns';\n\ninterface Props {\n  users: User[];\n  workTypes: WorkType[];\n  records: WorkRecord[];\n}\n\nconst AdminDashboard: React.FC<Props> = ({ users, workTypes, records }) => {\n  const notifications: Notification[] = React.useMemo(() => {\n    const list: Notification[] = [];\n    records.forEach(record => {\n      const type = workTypes.find(t => t.id === record.workTypeId);\n      if (!type) return;\n\n      const expiryField = type.fields.find(f => f.isExpiry);\n      const primaryField = type.fields.find(f => f.isPrimary) || type.fields[0];\n      \n      if (expiryField && record.data[expiryField.id]) {\n        const expiryDate = parseISO(record.data[expiryField.id]);\n        const days = differenceInDays(expiryDate, new Date());\n        \n        if (days <= 30) {\n          list.push({\n            id: record.id + '-notif',\n            recordId: record.id,\n            workTypeName: type.name,\n            primaryValue: record.data[primaryField.id] || 'Unnamed Record',\n            expiryDate: record.data[expiryField.id],\n            daysRemaining: days,\n            type: days < 0 ? 'urgent' : days <= 7 ? 'warning' : 'info'\n          });\n        }\n      }\n    });\n    return list.sort((a, b) => a.daysRemaining - b.daysRemaining);\n  }, [records, workTypes]);\n\n  return (\n    <div className=\"space-y-8\">\n      <header>\n        <h2 className=\"text-3xl font-bold text-slate-900\">Admin Command Center</h2>\n        <p className=\"text-slate-500\">Overview of office activities and critical deadlines.</p>\n      </header>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-6\">\n        <div className=\"bg-white p-6 rounded-2xl border border-slate-200 shadow-sm\">\n          <p className=\"text-slate-500 text-sm font-medium\">Team Members</p>\n          <p className=\"text-3xl font-bold mt-1\">{users.length - 1}</p>\n        </div>\n        <div className=\"bg-white p-6 rounded-2xl border border-slate-200 shadow-sm\">\n          <p className=\"text-slate-500 text-sm font-medium\">Work Types</p>\n          <p className=\"text-3xl font-bold mt-1\">{workTypes.length}</p>\n        </div>\n        <div className=\"bg-white p-6 rounded-2xl border border-slate-200 shadow-sm\">\n          <p className=\"text-slate-500 text-sm font-medium\">Total Records</p>\n          <p className=\"text-3xl font-bold mt-1\">{records.length}</p>\n        </div>\n        <div className=\"bg-white p-6 rounded-2xl border border-slate-200 shadow-sm\">\n          <p className=\"text-slate-500 text-sm font-medium\">Critical Deadlines</p>\n          <p className=\"text-3xl font-bold mt-1 text-red-600\">{notifications.filter(n => n.daysRemaining <= 7).length}</p>\n        </div>\n      </div>\n\n      <section>\n        <div className=\"flex items-center justify-between mb-4\">\n          <h3 className=\"text-xl font-bold text-slate-800\">Alerts & Expiries</h3>\n          <span className=\"px-3 py-1 bg-slate-100 text-slate-600 rounded-full text-xs font-bold uppercase\">Next 30 Days</span>\n        </div>\n\n        {notifications.length === 0 ? (\n          <div className=\"bg-white p-12 rounded-2xl border border-slate-200 text-center\">\n            <div className=\"text-4xl mb-4\">‚úÖ</div>\n            <p className=\"text-slate-500\">No urgent deadlines or upcoming expiries.</p>\n          </div>\n        ) : (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n            {notifications.map((notif) => (\n              <div \n                key={notif.id}\n                className={`p-4 rounded-xl border-l-4 shadow-sm bg-white flex flex-col justify-between ${\n                  notif.type === 'urgent' ? 'border-red-500' : \n                  notif.type === 'warning' ? 'border-amber-500' : 'border-indigo-500'\n                }`}\n              >\n                <div>\n                  <div className=\"flex justify-between items-start mb-2\">\n                    <span className=\"text-[10px] font-bold uppercase tracking-wider text-slate-400\">{notif.workTypeName}</span>\n                    <span className={`text-xs px-2 py-0.5 rounded-full font-semibold ${\n                      notif.daysRemaining < 0 ? 'bg-red-100 text-red-700' : \n                      notif.daysRemaining <= 7 ? 'bg-amber-100 text-amber-700' : 'bg-indigo-100 text-indigo-700'\n                    }`}>\n                      {notif.daysRemaining < 0 ? 'EXPIRED' : `${notif.daysRemaining} days left`}\n                    </span>\n                  </div>\n                  <h4 className=\"font-bold text-slate-800 line-clamp-1\">{notif.primaryValue}</h4>\n                  <p className=\"text-sm text-slate-500 mt-1\">Expiry: {notif.expiryDate}</p>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </section>\n    </div>\n  );\n};\n\nexport default AdminDashboard;\n"
            }
          ]
        },
        {
          "path": "components/EmployeeManager.tsx",
          "generationType": 0,
          "isDone": true,
          "description": "Admin component for managing employee accounts.",
          "diffs": [
            {
              "target": "",
              "replacement": "\nimport React, { useState } from 'react';\nimport { User, UserRole } from '../types';\n\ninterface Props {\n  users: User[];\n  onUpdate: (users: User[]) => void;\n}\n\nconst EmployeeManager: React.FC<Props> = ({ users, onUpdate }) => {\n  const [isAdding, setIsAdding] = useState(false);\n  const [editingId, setEditingId] = useState<string | null>(null);\n  const [formData, setFormData] = useState({\n    username: '',\n    password: '',\n    name: ''\n  });\n\n  const employees = users.filter(u => u.role === UserRole.EMPLOYEE);\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (editingId) {\n      const updated = users.map(u => u.id === editingId ? { ...u, ...formData } : u);\n      onUpdate(updated);\n    } else {\n      const newUser: User = {\n        id: `user-${Date.now()}`,\n        ...formData,\n        role: UserRole.EMPLOYEE,\n        createdAt: Date.now()\n      };\n      onUpdate([...users, newUser]);\n    }\n    resetForm();\n  };\n\n  const handleEdit = (user: User) => {\n    setFormData({\n      username: user.username,\n      password: user.password,\n      name: user.name\n    });\n    setEditingId(user.id);\n    setIsAdding(true);\n  };\n\n  const handleDelete = (id: string) => {\n    if (confirm('Are you sure you want to delete this employee? All their login access will be revoked.')) {\n      onUpdate(users.filter(u => u.id !== id));\n    }\n  };\n\n  const resetForm = () => {\n    setFormData({ username: '', password: '', name: '' });\n    setEditingId(null);\n    setIsAdding(false);\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex justify-between items-center\">\n        <h2 className=\"text-2xl font-bold text-slate-900\">Employee Management</h2>\n        {!isAdding && (\n          <button \n            onClick={() => setIsAdding(true)}\n            className=\"bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg font-semibold flex items-center space-x-2 transition-all\"\n          >\n            <span>‚ûï</span>\n            <span>Add New Employee</span>\n          </button>\n        )}\n      </div>\n\n      {isAdding && (\n        <div className=\"bg-white p-6 rounded-2xl border border-slate-200 shadow-lg\">\n          <h3 className=\"text-lg font-bold mb-4\">{editingId ? 'Edit Employee' : 'Create New Employee Account'}</h3>\n          <form onSubmit={handleSubmit} className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n            <div>\n              <label className=\"block text-xs font-bold text-slate-500 mb-1 uppercase\">Full Name</label>\n              <input \n                required\n                value={formData.name}\n                onChange={e => setFormData({...formData, name: e.target.value})}\n                className=\"w-full px-4 py-2 bg-slate-50 border border-slate-200 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none\"\n                placeholder=\"John Doe\"\n              />\n            </div>\n            <div>\n              <label className=\"block text-xs font-bold text-slate-500 mb-1 uppercase\">Username</label>\n              <input \n                required\n                value={formData.username}\n                onChange={e => setFormData({...formData, username: e.target.value})}\n                className=\"w-full px-4 py-2 bg-slate-50 border border-slate-200 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none\"\n                placeholder=\"johndoe123\"\n              />\n            </div>\n            <div>\n              <label className=\"block text-xs font-bold text-slate-500 mb-1 uppercase\">Password</label>\n              <input \n                required\n                type=\"password\"\n                value={formData.password}\n                onChange={e => setFormData({...formData, password: e.target.value})}\n                className=\"w-full px-4 py-2 bg-slate-50 border border-slate-200 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none\"\n                placeholder=\"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢\"\n              />\n            </div>\n            <div className=\"md:col-span-3 flex justify-end space-x-3 mt-2\">\n              <button \n                type=\"button\"\n                onClick={resetForm}\n                className=\"px-4 py-2 text-slate-500 hover:text-slate-700 font-medium\"\n              >\n                Cancel\n              </button>\n              <button \n                type=\"submit\"\n                className=\"bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-2 rounded-lg font-bold shadow-md shadow-indigo-100\"\n              >\n                {editingId ? 'Update Employee' : 'Save Employee'}\n              </button>\n            </div>\n          </form>\n        </div>\n      )}\n\n      <div className=\"bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden\">\n        <table className=\"w-full text-left\">\n          <thead className=\"bg-slate-50 border-b border-slate-200\">\n            <tr>\n              <th className=\"px-6 py-4 text-xs font-bold text-slate-400 uppercase tracking-wider\">Name</th>\n              <th className=\"px-6 py-4 text-xs font-bold text-slate-400 uppercase tracking-wider\">Username</th>\n              <th className=\"px-6 py-4 text-xs font-bold text-slate-400 uppercase tracking-wider\">Access Created</th>\n              <th className=\"px-6 py-4 text-xs font-bold text-slate-400 uppercase tracking-wider text-right\">Actions</th>\n            </tr>\n          </thead>\n          <tbody className=\"divide-y divide-slate-100\">\n            {employees.length === 0 ? (\n              <tr>\n                <td colSpan={4} className=\"px-6 py-12 text-center text-slate-400 italic\">No employees added yet.</td>\n              </tr>\n            ) : (\n              employees.map(emp => (\n                <tr key={emp.id} className=\"hover:bg-slate-50 transition-colors\">\n                  <td className=\"px-6 py-4\">\n                    <div className=\"flex items-center space-x-3\">\n                      <div className=\"w-8 h-8 rounded-full bg-slate-200 flex items-center justify-center font-bold text-slate-600\">\n                        {emp.name.charAt(0)}\n                      </div>\n                      <span className=\"font-semibold text-slate-700\">{emp.name}</span>\n                    </div>\n                  </td>\n                  <td className=\"px-6 py-4 text-slate-600\">{emp.username}</td>\n                  <td className=\"px-6 py-4 text-slate-500 text-sm\">{new Date(emp.createdAt).toLocaleDateString()}</td>\n                  <td className=\"px-6 py-4 text-right space-x-2\">\n                    <button \n                      onClick={() => handleEdit(emp)}\n                      className=\"p-2 text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors\"\n                      title=\"Edit\"\n                    >\n                      ‚úèÔ∏è\n                    </button>\n                    <button \n                      onClick={() => handleDelete(emp.id)}\n                      className=\"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors\"\n                      title=\"Delete\"\n                    >\n                      üóëÔ∏è\n                    </button>\n                  </td>\n                </tr>\n              ))\n            )}\n          </tbody>\n        </table>\n      </div>\n    </div>\n  );\n};\n\nexport default EmployeeManager;\n"
            }
          ]
        },
        {
          "path": "components/WorkTypeBuilder.tsx",
          "generationType": 0,
          "isDone": true,
          "description": "Dynamic form builder for admins to define office work types and their structure.",
          "diffs": [
            {
              "target": "",
              "replacement": "\nimport React, { useState } from 'react';\nimport { WorkType, FieldDefinition, FieldType } from '../types';\nimport { suggestFieldsForWorkType } from '../geminiService';\n\ninterface Props {\n  workTypes: WorkType[];\n  onUpdate: (types: WorkType[]) => void;\n}\n\nconst WorkTypeBuilder: React.FC<Props> = ({ workTypes, onUpdate }) => {\n  const [isCreating, setIsCreating] = useState(false);\n  const [loadingAI, setLoadingAI] = useState(false);\n  const [editingId, setEditingId] = useState<string | null>(null);\n  \n  const [typeName, setTypeName] = useState('');\n  const [typeDesc, setTypeDesc] = useState('');\n  const [fields, setFields] = useState<FieldDefinition[]>([]);\n\n  const handleAddField = () => {\n    const newField: FieldDefinition = {\n      id: `field-${Date.now()}`,\n      label: '',\n      type: FieldType.TEXT,\n      required: true,\n      isExpiry: false,\n      isPrimary: fields.length === 0\n    };\n    setFields([...fields, newField]);\n  };\n\n  const handleUpdateField = (id: string, updates: Partial<FieldDefinition>) => {\n    setFields(fields.map(f => f.id === id ? { ...f, ...updates } : f));\n  };\n\n  const handleRemoveField = (id: string) => {\n    setFields(fields.filter(f => f.id !== id));\n  };\n\n  const handleAISuggest = async () => {\n    if (!typeName) return alert(\"Please enter a name first!\");\n    setLoadingAI(true);\n    const suggested = await suggestFieldsForWorkType(typeName);\n    if (suggested && suggested.length > 0) {\n      const mapped = suggested.map((s: any, idx: number) => ({\n        id: `field-ai-${idx}-${Date.now()}`,\n        label: s.label,\n        type: s.type as FieldType,\n        required: s.required,\n        isExpiry: s.isExpiry,\n        isPrimary: s.isPrimary\n      }));\n      setFields(mapped);\n    }\n    setLoadingAI(false);\n  };\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (fields.length === 0) return alert(\"Please add at least one field.\");\n\n    const newType: WorkType = {\n      id: editingId || `worktype-${Date.now()}`,\n      name: typeName,\n      description: typeDesc,\n      fields: fields,\n      createdAt: Date.now()\n    };\n\n    if (editingId) {\n      onUpdate(workTypes.map(t => t.id === editingId ? newType : t));\n    } else {\n      onUpdate([...workTypes, newType]);\n    }\n    resetForm();\n  };\n\n  const handleEdit = (type: WorkType) => {\n    setTypeName(type.name);\n    setTypeDesc(type.description);\n    setFields(type.fields);\n    setEditingId(type.id);\n    setIsCreating(true);\n  };\n\n  const handleDelete = (id: string) => {\n    if (confirm('Deleting this work type will not delete existing records, but may break how they are displayed. Continue?')) {\n      onUpdate(workTypes.filter(t => t.id !== id));\n    }\n  };\n\n  const resetForm = () => {\n    setTypeName('');\n    setTypeDesc('');\n    setFields([]);\n    setEditingId(null);\n    setIsCreating(false);\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h2 className=\"text-2xl font-bold text-slate-900\">Work Page Setup</h2>\n          <p className=\"text-slate-500 text-sm\">Design custom forms and data structures for different office tasks.</p>\n        </div>\n        {!isCreating && (\n          <button \n            onClick={() => setIsCreating(true)}\n            className=\"bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg font-semibold flex items-center space-x-2 shadow-lg shadow-indigo-100\"\n          >\n            <span>‚ú®</span>\n            <span>Create New Layout</span>\n          </button>\n        )}\n      </div>\n\n      {isCreating && (\n        <div className=\"bg-white p-8 rounded-2xl border border-slate-200 shadow-xl space-y-6\">\n          <div className=\"flex justify-between items-start\">\n            <h3 className=\"text-xl font-bold\">{editingId ? 'Edit Layout' : 'New Layout Builder'}</h3>\n            <button onClick={resetForm} className=\"text-slate-400 hover:text-slate-600\">‚úï</button>\n          </div>\n\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n            <div className=\"space-y-4\">\n              <div>\n                <label className=\"block text-xs font-bold text-slate-400 uppercase mb-1\">Layout Name</label>\n                <div className=\"flex space-x-2\">\n                  <input \n                    required\n                    value={typeName}\n                    onChange={e => setTypeName(e.target.value)}\n                    className=\"flex-1 px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none font-semibold text-lg\"\n                    placeholder=\"e.g., Professional Tax Registration\"\n                  />\n                  <button \n                    type=\"button\"\n                    onClick={handleAISuggest}\n                    disabled={loadingAI}\n                    className=\"px-4 py-2 bg-indigo-50 text-indigo-700 rounded-xl font-bold text-xs hover:bg-indigo-100 disabled:opacity-50 flex flex-col items-center justify-center min-w-[100px]\"\n                  >\n                    {loadingAI ? '...' : 'ü§ñ Suggest Fields'}\n                  </button>\n                </div>\n              </div>\n              <div>\n                <label className=\"block text-xs font-bold text-slate-400 uppercase mb-1\">Description (Optional)</label>\n                <textarea \n                  value={typeDesc}\n                  onChange={e => setTypeDesc(e.target.value)}\n                  className=\"w-full px-4 py-2 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none h-20\"\n                  placeholder=\"Describe the purpose of this work page...\"\n                />\n              </div>\n            </div>\n\n            <div className=\"bg-slate-50 p-4 rounded-2xl border border-slate-200 overflow-y-auto max-h-[400px]\">\n              <div className=\"flex justify-between items-center mb-4\">\n                <h4 className=\"text-sm font-bold text-slate-700 uppercase\">Field Configuration</h4>\n                <button \n                  type=\"button\" \n                  onClick={handleAddField}\n                  className=\"text-xs font-bold bg-white px-2 py-1 border border-slate-200 rounded shadow-sm hover:bg-white\"\n                >\n                  + Add Field\n                </button>\n              </div>\n\n              <div className=\"space-y-3\">\n                {fields.length === 0 && (\n                  <div className=\"text-center py-8 text-slate-400 text-sm italic\">\n                    No fields added. Click + Add Field or use AI Suggest.\n                  </div>\n                )}\n                {fields.map((field, idx) => (\n                  <div key={field.id} className=\"bg-white p-4 rounded-xl border border-slate-200 shadow-sm relative group\">\n                    <button \n                      onClick={() => handleRemoveField(field.id)}\n                      className=\"absolute top-2 right-2 text-slate-300 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity\"\n                    >\n                      üóëÔ∏è\n                    </button>\n                    <div className=\"grid grid-cols-2 gap-3 mb-3\">\n                      <div>\n                        <input \n                          value={field.label}\n                          onChange={e => handleUpdateField(field.id, { label: e.target.value })}\n                          className=\"w-full text-sm font-bold border-b border-transparent hover:border-slate-200 focus:border-indigo-500 outline-none\"\n                          placeholder=\"Field Label\"\n                        />\n                      </div>\n                      <select \n                        value={field.type}\n                        onChange={e => handleUpdateField(field.id, { type: e.target.value as FieldType })}\n                        className=\"text-xs bg-slate-50 border-none rounded outline-none\"\n                      >\n                        {Object.values(FieldType).map(t => <option key={t} value={t}>{t.toUpperCase()}</option>)}\n                      </select>\n                    </div>\n                    <div className=\"flex items-center space-x-4 text-[10px] font-bold text-slate-500\">\n                      <label className=\"flex items-center space-x-1 cursor-pointer\">\n                        <input \n                          type=\"checkbox\" \n                          checked={field.required} \n                          onChange={e => handleUpdateField(field.id, { required: e.target.checked })}\n                        />\n                        <span>REQUIRED</span>\n                      </label>\n                      <label className=\"flex items-center space-x-1 cursor-pointer text-amber-600\">\n                        <input \n                          type=\"checkbox\" \n                          checked={field.isExpiry} \n                          onChange={e => handleUpdateField(field.id, { isExpiry: e.target.checked })}\n                        />\n                        <span>EXPIRY DATE</span>\n                      </label>\n                      <label className=\"flex items-center space-x-1 cursor-pointer text-indigo-600\">\n                        <input \n                          type=\"radio\" \n                          name=\"primary-field\"\n                          checked={field.isPrimary} \n                          onChange={() => {\n                            setFields(fields.map(f => ({ ...f, isPrimary: f.id === field.id })));\n                          }}\n                        />\n                        <span>TITLE FIELD</span>\n                      </label>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </div>\n          </div>\n\n          <div className=\"flex justify-end space-x-4 pt-4 border-t border-slate-100\">\n            <button onClick={resetForm} className=\"px-6 py-2 font-semibold text-slate-600\">Cancel</button>\n            <button \n              onClick={handleSubmit}\n              className=\"px-8 py-3 bg-indigo-600 hover:bg-indigo-700 text-white rounded-xl font-bold shadow-lg shadow-indigo-200\"\n            >\n              {editingId ? 'Update Layout' : 'Finish & Save Layout'}\n            </button>\n          </div>\n        </div>\n      )}\n\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n        {workTypes.map(type => (\n          <div key={type.id} className=\"bg-white p-6 rounded-2xl border border-slate-200 shadow-sm hover:shadow-md transition-shadow flex flex-col justify-between\">\n            <div>\n              <div className=\"flex justify-between items-start mb-4\">\n                <div className=\"w-12 h-12 bg-indigo-50 text-indigo-600 flex items-center justify-center rounded-xl text-2xl\">\n                  üìÅ\n                </div>\n                <div className=\"space-x-1\">\n                  <button onClick={() => handleEdit(type)} className=\"p-2 hover:bg-indigo-50 rounded-lg text-indigo-600\">‚úèÔ∏è</button>\n                  <button onClick={() => handleDelete(type.id)} className=\"p-2 hover:bg-red-50 rounded-lg text-red-600\">üóëÔ∏è</button>\n                </div>\n              </div>\n              <h3 className=\"text-xl font-bold text-slate-800\">{type.name}</h3>\n              <p className=\"text-slate-500 text-sm mt-1 line-clamp-2 h-10\">{type.description || 'No description provided.'}</p>\n            </div>\n            <div className=\"mt-6 pt-6 border-t border-slate-50 flex items-center justify-between\">\n              <span className=\"text-xs font-bold text-slate-400 uppercase tracking-widest\">{type.fields.length} Fields</span>\n              <span className=\"text-[10px] text-slate-300\">Created {new Date(type.createdAt).toLocaleDateString()}</span>\n            </div>\n          </div>\n        ))}\n\n        {workTypes.length === 0 && !isCreating && (\n          <div className=\"col-span-full py-20 bg-slate-50 border-2 border-dashed border-slate-200 rounded-3xl flex flex-col items-center justify-center text-slate-400\">\n            <p className=\"text-lg font-medium\">No work types defined yet.</p>\n            <button onClick={() => setIsCreating(true)} className=\"mt-4 text-indigo-600 font-bold hover:underline underline-offset-4\">Click here to build your first work page layout</button>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default WorkTypeBuilder;\n"
            }
          ]
        },
        {
          "path": "components/EmployeeDashboard.tsx",
          "generationType": 0,
          "isDone": true,
          "description": "Dashboard for employees to see their recent activities and urgent deadlines.",
          "diffs": [
            {
              "target": "",
              "replacement": "\nimport React from 'react';\nimport { User, WorkType, WorkRecord, Notification } from '../types';\nimport { differenceInDays, parseISO } from 'date-fns';\n\ninterface Props {\n  user: User;\n  workTypes: WorkType[];\n  records: WorkRecord[];\n  onNewEntry: (typeId: string) => void;\n}\n\nconst EmployeeDashboard: React.FC<Props> = ({ user, workTypes, records, onNewEntry }) => {\n  const myRecords = records.filter(r => r.employeeId === user.id);\n  \n  const notifications: Notification[] = React.useMemo(() => {\n    const list: Notification[] = [];\n    myRecords.forEach(record => {\n      const type = workTypes.find(t => t.id === record.workTypeId);\n      if (!type) return;\n\n      const expiryField = type.fields.find(f => f.isExpiry);\n      const primaryField = type.fields.find(f => f.isPrimary) || type.fields[0];\n      \n      if (expiryField && record.data[expiryField.id]) {\n        const expiryDate = parseISO(record.data[expiryField.id]);\n        const days = differenceInDays(expiryDate, new Date());\n        \n        if (days <= 30) {\n          list.push({\n            id: record.id + '-notif',\n            recordId: record.id,\n            workTypeName: type.name,\n            primaryValue: record.data[primaryField.id] || 'Unnamed Record',\n            expiryDate: record.data[expiryField.id],\n            daysRemaining: days,\n            type: days < 0 ? 'urgent' : days <= 7 ? 'warning' : 'info'\n          });\n        }\n      }\n    });\n    return list.sort((a, b) => a.daysRemaining - b.daysRemaining);\n  }, [myRecords, workTypes]);\n\n  return (\n    <div className=\"space-y-8\">\n      <header>\n        <h2 className=\"text-3xl font-bold text-slate-900 text-balance\">Welcome back, {user.name}!</h2>\n        <p className=\"text-slate-500\">Ready to handle some professional tax and trade license work today?</p>\n      </header>\n\n      {/* Quick Action */}\n      <section className=\"bg-indigo-600 p-8 rounded-3xl text-white shadow-xl shadow-indigo-100 relative overflow-hidden\">\n        <div className=\"relative z-10\">\n          <h3 className=\"text-xl font-bold mb-2\">New Submission</h3>\n          <p className=\"text-indigo-100 mb-6 max-w-md\">Start a new entry for professional tax, pan card, or trade licenses by selecting a category below.</p>\n          <div className=\"flex flex-wrap gap-2\">\n            {workTypes.length === 0 ? (\n              <p className=\"text-sm italic opacity-70\">Admin hasn't configured any work types yet.</p>\n            ) : (\n              workTypes.map(wt => (\n                <button \n                  key={wt.id}\n                  onClick={() => onNewEntry(wt.id)}\n                  className=\"bg-white text-indigo-700 px-4 py-2 rounded-xl font-bold hover:bg-indigo-50 transition-colors shadow-sm\"\n                >\n                  {wt.name}\n                </button>\n              ))\n            )}\n          </div>\n        </div>\n        <div className=\"absolute top-0 right-0 p-4 opacity-10 text-9xl\">üìã</div>\n      </section>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n        <div className=\"lg:col-span-2 space-y-6\">\n          <h3 className=\"text-xl font-bold text-slate-800\">Your Recent Activity</h3>\n          {myRecords.length === 0 ? (\n            <div className=\"bg-white p-12 rounded-2xl border border-slate-200 text-center text-slate-400\">\n              No records submitted yet.\n            </div>\n          ) : (\n            <div className=\"bg-white rounded-2xl border border-slate-200 overflow-hidden shadow-sm\">\n              <table className=\"w-full text-left\">\n                <thead className=\"bg-slate-50 border-b border-slate-200\">\n                  <tr>\n                    <th className=\"px-6 py-4 text-xs font-bold text-slate-400 uppercase\">Work Category</th>\n                    <th className=\"px-6 py-4 text-xs font-bold text-slate-400 uppercase\">Description</th>\n                    <th className=\"px-6 py-4 text-xs font-bold text-slate-400 uppercase\">Submitted</th>\n                  </tr>\n                </thead>\n                <tbody className=\"divide-y divide-slate-100\">\n                  {myRecords.slice(0, 5).map(rec => {\n                    const wt = workTypes.find(t => t.id === rec.workTypeId);\n                    const primary = wt?.fields.find(f => f.isPrimary);\n                    return (\n                      <tr key={rec.id} className=\"hover:bg-slate-50\">\n                        <td className=\"px-6 py-4 font-bold text-indigo-600\">{wt?.name || 'Deleted Type'}</td>\n                        <td className=\"px-6 py-4 text-slate-700\">{primary ? rec.data[primary.id] : 'N/A'}</td>\n                        <td className=\"px-6 py-4 text-slate-400 text-sm\">{new Date(rec.createdAt).toLocaleDateString()}</td>\n                      </tr>\n                    );\n                  })}\n                </tbody>\n              </table>\n            </div>\n          )}\n        </div>\n\n        <div className=\"space-y-6\">\n          <h3 className=\"text-xl font-bold text-slate-800 flex items-center\">\n            <span>üìÖ</span>\n            <span className=\"ml-2\">Action Required</span>\n          </h3>\n          <div className=\"space-y-4\">\n            {notifications.length === 0 ? (\n              <div className=\"bg-slate-100/50 p-6 rounded-2xl text-slate-500 text-center border-2 border-dashed border-slate-200\">\n                <p>All clear! No upcoming expiries for your accounts.</p>\n              </div>\n            ) : (\n              notifications.map(notif => (\n                <div \n                  key={notif.id}\n                  className={`p-4 rounded-2xl bg-white border-2 shadow-sm ${\n                    notif.type === 'urgent' ? 'border-red-100' : 'border-indigo-50'\n                  }`}\n                >\n                  <div className=\"flex justify-between items-start mb-2\">\n                    <span className=\"text-[10px] font-bold text-slate-400 uppercase\">{notif.workTypeName}</span>\n                    <span className={`text-[10px] px-2 py-0.5 rounded-full font-bold uppercase ${\n                      notif.daysRemaining < 0 ? 'bg-red-500 text-white' : \n                      notif.daysRemaining <= 7 ? 'bg-amber-500 text-white' : 'bg-indigo-500 text-white'\n                    }`}>\n                      {notif.daysRemaining < 0 ? 'EXPIRED' : `${notif.daysRemaining}d`}\n                    </span>\n                  </div>\n                  <h4 className=\"font-bold text-slate-800 text-sm\">{notif.primaryValue}</h4>\n                  <p className=\"text-xs text-slate-500 mt-1\">Due Date: {notif.expiryDate}</p>\n                </div>\n              ))\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default EmployeeDashboard;\n"
            }
          ]
        },
        {
          "path": "components/WorkEntryForm.tsx",
          "generationType": 0,
          "isDone": true,
          "description": "Dynamic form generator that uses the Admin's layout to let employees submit data.",
          "diffs": [
            {
              "target": "",
              "replacement": "\nimport React, { useState } from 'react';\nimport { WorkType, WorkRecord, User, FieldType } from '../types';\n\ninterface Props {\n  workType: WorkType;\n  user: User;\n  onSave: (record: WorkRecord) => void;\n  onCancel: () => void;\n}\n\nconst WorkEntryForm: React.FC<Props> = ({ workType, user, onSave, onCancel }) => {\n  const [formData, setFormData] = useState<Record<string, any>>({});\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    const newRecord: WorkRecord = {\n      id: `record-${Date.now()}`,\n      workTypeId: workType.id,\n      employeeId: user.id,\n      data: formData,\n      createdAt: Date.now(),\n      lastUpdated: Date.now()\n    };\n    onSave(newRecord);\n  };\n\n  const handleFieldChange = (fieldId: string, value: any) => {\n    setFormData(prev => ({ ...prev, [fieldId]: value }));\n  };\n\n  return (\n    <div className=\"bg-white rounded-3xl border border-slate-200 shadow-xl overflow-hidden\">\n      <div className=\"p-8 border-b border-slate-100 bg-slate-50/50\">\n        <h2 className=\"text-2xl font-bold text-slate-800\">{workType.name}</h2>\n        <p className=\"text-slate-500 mt-1\">{workType.description || 'Fill out the details below to register this work entry.'}</p>\n      </div>\n\n      <form onSubmit={handleSubmit} className=\"p-8 space-y-6\">\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6\">\n          {workType.fields.map(field => (\n            <div key={field.id} className={field.type === FieldType.CHECKBOX ? 'flex items-center space-x-3 pt-6' : 'space-y-1'}>\n              {field.type !== FieldType.CHECKBOX && (\n                <label className=\"block text-sm font-bold text-slate-600\">\n                  {field.label}\n                  {field.required && <span className=\"text-red-500 ml-1\">*</span>}\n                  {field.isExpiry && <span className=\"text-amber-600 text-[10px] ml-2 font-black uppercase tracking-widest\">Expiry Tracker</span>}\n                </label>\n              )}\n\n              {field.type === FieldType.TEXT && (\n                <input \n                  required={field.required}\n                  type=\"text\"\n                  value={formData[field.id] || ''}\n                  onChange={e => handleFieldChange(field.id, e.target.value)}\n                  className=\"w-full px-4 py-2 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none\"\n                  placeholder={`Enter ${field.label.toLowerCase()}`}\n                />\n              )}\n\n              {field.type === FieldType.NUMBER && (\n                <input \n                  required={field.required}\n                  type=\"number\"\n                  value={formData[field.id] || ''}\n                  onChange={e => handleFieldChange(field.id, e.target.value)}\n                  className=\"w-full px-4 py-2 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none\"\n                />\n              )}\n\n              {field.type === FieldType.DATE && (\n                <input \n                  required={field.required}\n                  type=\"date\"\n                  value={formData[field.id] || ''}\n                  onChange={e => handleFieldChange(field.id, e.target.value)}\n                  className=\"w-full px-4 py-2 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none\"\n                />\n              )}\n\n              {field.type === FieldType.SELECT && (\n                <select \n                  required={field.required}\n                  value={formData[field.id] || ''}\n                  onChange={e => handleFieldChange(field.id, e.target.value)}\n                  className=\"w-full px-4 py-2 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none bg-white\"\n                >\n                  <option value=\"\">Select Option</option>\n                  {field.options?.map(opt => <option key={opt} value={opt}>{opt}</option>)}\n                </select>\n              )}\n\n              {field.type === FieldType.CHECKBOX && (\n                <>\n                  <input \n                    type=\"checkbox\"\n                    checked={formData[field.id] || false}\n                    onChange={e => handleFieldChange(field.id, e.target.checked)}\n                    className=\"w-5 h-5 text-indigo-600 border-slate-300 rounded focus:ring-indigo-500\"\n                  />\n                  <label className=\"text-sm font-bold text-slate-600\">{field.label}</label>\n                </>\n              )}\n            </div>\n          ))}\n        </div>\n\n        <div className=\"flex justify-end space-x-4 pt-8 mt-4 border-t border-slate-100\">\n          <button \n            type=\"button\" \n            onClick={onCancel}\n            className=\"px-6 py-2 font-semibold text-slate-400 hover:text-slate-600 transition-colors\"\n          >\n            Cancel Entry\n          </button>\n          <button \n            type=\"submit\"\n            className=\"px-10 py-3 bg-indigo-600 hover:bg-indigo-700 text-white rounded-xl font-bold shadow-lg shadow-indigo-100 transition-all active:scale-95\"\n          >\n            Submit Record\n          </button>\n        </div>\n      </form>\n    </div>\n  );\n};\n\nexport default WorkEntryForm;\n"
            }
          ]
        },
        {
          "path": "components/RecordList.tsx",
          "generationType": 0,
          "isDone": true,
          "description": "Display component for viewing submitted office records.",
          "diffs": [
            {
              "target": "",
              "replacement": "\nimport React, { useState } from 'react';\nimport { WorkType, WorkRecord, User, UserRole } from '../types';\n\ninterface Props {\n  records: WorkRecord[];\n  workTypes: WorkType[];\n  users: User[];\n  currentUser: User;\n}\n\nconst RecordList: React.FC<Props> = ({ records, workTypes, users, currentUser }) => {\n  const [filterType, setFilterType] = useState<string>('all');\n  \n  const isAdmin = currentUser.role === UserRole.ADMIN;\n  const filteredRecords = records.filter(rec => {\n    const isOwner = isAdmin || rec.employeeId === currentUser.id;\n    const isCorrectType = filterType === 'all' || rec.workTypeId === filterType;\n    return isOwner && isCorrectType;\n  });\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex justify-between items-center\">\n        <h2 className=\"text-2xl font-bold text-slate-900\">Office Records</h2>\n        <div className=\"flex space-x-2\">\n          <select \n            value={filterType}\n            onChange={e => setFilterType(e.target.value)}\n            className=\"bg-white px-4 py-2 border border-slate-200 rounded-lg text-sm font-medium outline-none\"\n          >\n            <option value=\"all\">All Work Categories</option>\n            {workTypes.map(wt => <option key={wt.id} value={wt.id}>{wt.name}</option>)}\n          </select>\n        </div>\n      </div>\n\n      <div className=\"bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden\">\n        <div className=\"overflow-x-auto\">\n          <table className=\"w-full text-left\">\n            <thead className=\"bg-slate-50 border-b border-slate-200\">\n              <tr>\n                <th className=\"px-6 py-4 text-xs font-bold text-slate-400 uppercase\">Category</th>\n                <th className=\"px-6 py-4 text-xs font-bold text-slate-400 uppercase\">Record Identity</th>\n                {isAdmin && <th className=\"px-6 py-4 text-xs font-bold text-slate-400 uppercase\">Employee</th>}\n                <th className=\"px-6 py-4 text-xs font-bold text-slate-400 uppercase\">Date Logged</th>\n                <th className=\"px-6 py-4 text-xs font-bold text-slate-400 uppercase\">Details</th>\n              </tr>\n            </thead>\n            <tbody className=\"divide-y divide-slate-100\">\n              {filteredRecords.length === 0 ? (\n                <tr>\n                  <td colSpan={5} className=\"px-6 py-12 text-center text-slate-400 italic\">No records found matching your criteria.</td>\n                </tr>\n              ) : (\n                filteredRecords.map(rec => {\n                  const type = workTypes.find(t => t.id === rec.workTypeId);\n                  const emp = users.find(u => u.id === rec.employeeId);\n                  const primaryField = type?.fields.find(f => f.isPrimary) || type?.fields[0];\n                  \n                  return (\n                    <tr key={rec.id} className=\"hover:bg-slate-50 transition-colors\">\n                      <td className=\"px-6 py-4\">\n                        <span className=\"px-2 py-1 bg-indigo-50 text-indigo-700 text-[10px] font-bold uppercase rounded-md\">\n                          {type?.name || 'Deleted Type'}\n                        </span>\n                      </td>\n                      <td className=\"px-6 py-4 font-bold text-slate-800\">\n                        {primaryField ? rec.data[primaryField.id] : 'No Title'}\n                      </td>\n                      {isAdmin && (\n                        <td className=\"px-6 py-4 text-sm text-slate-600\">\n                          {emp?.name || 'Unknown'}\n                        </td>\n                      )}\n                      <td className=\"px-6 py-4 text-sm text-slate-400\">\n                        {new Date(rec.createdAt).toLocaleDateString()}\n                      </td>\n                      <td className=\"px-6 py-4\">\n                        <button className=\"text-indigo-600 text-xs font-bold hover:underline\">View All Fields</button>\n                      </td>\n                    </tr>\n                  );\n                })\n              )}\n            </tbody>\n          </table>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default RecordList;\n"
            }
          ]
        },
        {
          "path": "App.tsx",
          "generationType": 0,
          "isDone": true,
          "description": "Main application logic, routing, and state management.",
          "diffs": [
            {
              "target": "",
              "replacement": "\nimport React, { useState, useEffect } from 'react';\nimport { User, UserRole, WorkType, WorkRecord } from './types';\nimport { Storage } from './storage';\nimport LoginPage from './components/LoginPage';\nimport Layout from './components/Layout';\nimport AdminDashboard from './components/AdminDashboard';\nimport EmployeeManager from './components/EmployeeManager';\nimport WorkTypeBuilder from './components/WorkTypeBuilder';\nimport EmployeeDashboard from './components/EmployeeDashboard';\nimport WorkEntryForm from './components/WorkEntryForm';\nimport RecordList from './components/RecordList';\n\nconst App: React.FC = () => {\n  const [user, setUser] = useState<User | null>(null);\n  const [activeTab, setActiveTab] = useState<string>('dashboard');\n  \n  const [users, setUsers] = useState<User[]>(Storage.getUsers());\n  const [workTypes, setWorkTypes] = useState<WorkType[]>(Storage.getWorkTypes());\n  const [records, setRecords] = useState<WorkRecord[]>(Storage.getWorkRecords());\n\n  // Handle Work Selection for Employees\n  const [selectedWorkType, setSelectedWorkType] = useState<WorkType | null>(null);\n\n  useEffect(() => {\n    Storage.saveUsers(users);\n  }, [users]);\n\n  useEffect(() => {\n    Storage.saveWorkTypes(workTypes);\n  }, [workTypes]);\n\n  useEffect(() => {\n    Storage.saveWorkRecords(records);\n  }, [records]);\n\n  const handleLogin = (u: User) => {\n    setUser(u);\n    setActiveTab('dashboard');\n  };\n\n  const handleLogout = () => {\n    setUser(null);\n    setSelectedWorkType(null);\n  };\n\n  const handleNewEntry = (typeId: string) => {\n    const type = workTypes.find(t => t.id === typeId);\n    if (type) {\n      setSelectedWorkType(type);\n      setActiveTab('work-entry-form');\n    }\n  };\n\n  if (!user) {\n    return <LoginPage users={users} onLogin={handleLogin} />;\n  }\n\n  const renderContent = () => {\n    if (user.role === UserRole.ADMIN) {\n      switch (activeTab) {\n        case 'dashboard':\n          return <AdminDashboard users={users} workTypes={workTypes} records={records} />;\n        case 'employees':\n          return <EmployeeManager users={users} onUpdate={setUsers} />;\n        case 'work-types':\n          return <WorkTypeBuilder workTypes={workTypes} onUpdate={setWorkTypes} />;\n        case 'all-records':\n          return <RecordList records={records} workTypes={workTypes} users={users} currentUser={user} />;\n        default:\n          return <AdminDashboard users={users} workTypes={workTypes} records={records} />;\n      }\n    } else {\n      switch (activeTab) {\n        case 'dashboard':\n          return (\n            <EmployeeDashboard \n              user={user} \n              workTypes={workTypes} \n              records={records} \n              onNewEntry={handleNewEntry} \n            />\n          );\n        case 'work-entry':\n          return (\n            <div className=\"space-y-6\">\n              <h2 className=\"text-2xl font-bold text-slate-800\">Select Work Category</h2>\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n                {workTypes.map(wt => (\n                  <button \n                    key={wt.id}\n                    onClick={() => handleNewEntry(wt.id)}\n                    className=\"bg-white p-8 rounded-2xl border-2 border-slate-100 hover:border-indigo-500 hover:shadow-lg transition-all text-left\"\n                  >\n                    <div className=\"w-12 h-12 bg-indigo-50 text-indigo-600 rounded-xl flex items-center justify-center text-xl mb-4\">üìÑ</div>\n                    <h3 className=\"text-xl font-bold\">{wt.name}</h3>\n                    <p className=\"text-slate-500 text-sm mt-1\">{wt.description || 'Register a new entry'}</p>\n                  </button>\n                ))}\n              </div>\n            </div>\n          );\n        case 'work-entry-form':\n          if (!selectedWorkType) {\n            setActiveTab('work-entry');\n            return null;\n          }\n          return (\n            <WorkEntryForm \n              workType={selectedWorkType} \n              user={user} \n              onSave={(rec) => {\n                setRecords([rec, ...records]);\n                setActiveTab('my-records');\n                setSelectedWorkType(null);\n              }}\n              onCancel={() => {\n                setActiveTab('dashboard');\n                setSelectedWorkType(null);\n              }}\n            />\n          );\n        case 'my-records':\n          return <RecordList records={records} workTypes={workTypes} users={users} currentUser={user} />;\n        default:\n          return <EmployeeDashboard user={user} workTypes={workTypes} records={records} onNewEntry={handleNewEntry} />;\n      }\n    }\n  };\n\n  return (\n    <Layout \n      user={user} \n      onLogout={handleLogout} \n      activeTab={activeTab} \n      setActiveTab={setActiveTab}\n    >\n      {renderContent()}\n    </Layout>\n  );\n};\n\nexport default App;\n"
            }
          ]
        },
        {
          "path": "components/LoginPage.tsx",
          "generationType": 0,
          "isDone": true,
          "description": "Login screen with professional aesthetics.",
          "diffs": [
            {
              "target": "",
              "replacement": "\nimport React, { useState } from 'react';\nimport { User } from '../types';\n\ninterface Props {\n  users: User[];\n  onLogin: (user: User) => void;\n}\n\nconst LoginPage: React.FC<Props> = ({ users, onLogin }) => {\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const [error, setError] = useState('');\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    const foundUser = users.find(u => u.username === username && u.password === password);\n    if (foundUser) {\n      onLogin(foundUser);\n    } else {\n      setError('Invalid username or password. Please check your credentials.');\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-slate-100 flex items-center justify-center p-6\">\n      <div className=\"max-w-md w-full\">\n        <div className=\"bg-white rounded-3xl shadow-2xl overflow-hidden border border-slate-200\">\n          <div className=\"bg-indigo-600 p-10 text-center\">\n            <div className=\"w-16 h-16 bg-white/20 rounded-2xl mx-auto flex items-center justify-center text-3xl mb-4 backdrop-blur-sm\">üè¢</div>\n            <h1 className=\"text-2xl font-black text-white uppercase tracking-tighter\">OfficeHub Pro</h1>\n            <p className=\"text-indigo-100 text-sm mt-1\">Tax & License Management System</p>\n          </div>\n          \n          <div className=\"p-10\">\n            <form onSubmit={handleSubmit} className=\"space-y-6\">\n              <div>\n                <label className=\"block text-xs font-bold text-slate-500 mb-1 uppercase tracking-widest\">Username</label>\n                <input \n                  required\n                  type=\"text\"\n                  value={username}\n                  onChange={e => setUsername(e.target.value)}\n                  className=\"w-full px-5 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none transition-all font-medium\"\n                  placeholder=\"Enter your username\"\n                />\n              </div>\n              <div>\n                <label className=\"block text-xs font-bold text-slate-500 mb-1 uppercase tracking-widest\">Password</label>\n                <input \n                  required\n                  type=\"password\"\n                  value={password}\n                  onChange={e => setPassword(e.target.value)}\n                  className=\"w-full px-5 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none transition-all font-medium\"\n                  placeholder=\"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢\"\n                />\n              </div>\n\n              {error && (\n                <div className=\"p-4 bg-red-50 text-red-600 text-sm font-medium rounded-xl border border-red-100\">\n                  {error}\n                </div>\n              )}\n\n              <button \n                type=\"submit\"\n                className=\"w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-4 rounded-xl shadow-lg shadow-indigo-100 transition-all active:scale-95\"\n              >\n                Sign In to Dashboard\n              </button>\n            </form>\n\n            <div className=\"mt-8 pt-8 border-t border-slate-100 text-center\">\n              <p className=\"text-xs text-slate-400 font-medium\">Default Admin: admin / admin</p>\n              <p className=\"text-xs text-slate-400 mt-1 italic\">Authorized Personnel Only</p>\n            </div>\n          </div>\n        </div>\n        <p className=\"text-center mt-8 text-slate-400 text-sm\">¬© 2024 Professional Office Suite ‚Ä¢ Secure Local Storage</p>\n      </div>\n    </div>\n  );\n};\n\nexport default LoginPage;\n"
            }
          ]
        },
        {
          "path": "index.tsx",
          "generationType": 0,
          "isDone": true,
          "description": "Main entry point for React 18+.",
          "diffs": [
            {
              "target": "",
              "replacement": "\nimport React from 'react';\nimport ReactDOM from 'react-dom/client';\nimport App from './App';\n\nconst rootElement = document.getElementById('root');\nif (!rootElement) {\n  throw new Error(\"Could not find root element to mount to\");\n}\n\nconst root = ReactDOM.createRoot(rootElement);\nroot.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>\n);\n"
            }
          ]
        }
      ]
    },
    "createdTimestamp": {
      "seconds": 1771080978,
      "nanos": 519000000
    },
    "doneTimestamp": {
      "seconds": 1771080979,
      "nanos": 555000000
    }
  },
  {
    "id": 4,
    "author": "user",
    "payload": {
      "type": "text",
      "text": "when admin create a new work type then that work type should be automatically added to the sidebar of the employee dashboard nad no \"New Work Entry\" tab should be there, also once a record is save everthing can be edited by the admin if required and also can be deleted , if admin wants to delete an employee or an work type or an field or and entry a confirmation box should open with a dialog asking for employee name,work type name or in case of entry asking for the company name or the customer name for verification and that detail should be written on the textfield but as a placeholder for admins sake on providing that detail if it matches and admin click on delete then that particular thing should be deleted",
      "files": [],
      "fileUploads": [],
      "cssBlocks": [],
      "cMarkNode": {}
    },
    "createdTimestamp": {
      "seconds": 1771083855,
      "nanos": 281000000
    }
  },
  {
    "id": 5,
    "author": "model",
    "payload": {
      "type": "thinking",
      "text": "**Refining OfficeHub Pro**\n\nI'm currently focused on the updates needed for \"OfficeHub Pro.\" My primary concern is that new work types, configured by the administrator, need to be automatically and seamlessly reflected in each employee's sidebar. This auto-population is key.\n\n\n**Streamlining Employee Interface**\n\nMy thinking has shifted to streamlining the employee interface. Specifically, I'm working on removing the \"New Work Entry\" tab and making the dynamic work types the entry points instead. The focus is on integrating the `workTypes` state into the sidebar navigation. Also, I plan to update `Layout.tsx` and integrate the dynamic types. I am also planning on creating a \"Safe Delete Modal\" for admins.\n\n\n**Implementing Delete Safeguards**\n\nI'm now implementing safeguards for record deletion. I've created the `SafeDeleteModal` component, which includes a name-matching confirmation step, and it is being integrated into `EmployeeManager.tsx` and `WorkTypeBuilder.tsx`. Also, I'm updating `RecordList.tsx` to include \"Edit\" and \"Delete\" buttons for admins and setting up state for editing records. The `App.tsx` updates involve record state passing and sidebar routing for dynamic work types. Sidebar logic is also getting refined.\n\n\n",
      "cMarkNode": {}
    },
    "createdTimestamp": {
      "seconds": 1771083855,
      "nanos": 281000000
    },
    "doneTimestamp": {
      "seconds": 1771083865,
      "nanos": 327000000
    }
  },
  {
    "id": 6,
    "author": "model",
    "payload": {
      "type": "generationTable",
      "entries": [
        {
          "path": "components/SafeDeleteModal.tsx",
          "generationType": 1,
          "isDone": true,
          "description": "A secure confirmation modal requiring the user to type the entity name to confirm deletion.",
          "diffs": [
            {
              "target": "",
              "replacement": "\nimport React, { useState } from 'react';\n\ninterface SafeDeleteModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onConfirm: () => void;\n  entityName: string;\n  entityType: string;\n}\n\nconst SafeDeleteModal: React.FC<SafeDeleteModalProps> = ({ isOpen, onClose, onConfirm, entityName, entityType }) => {\n  const [inputValue, setInputValue] = useState('');\n\n  if (!isOpen) return null;\n\n  const isMatched = inputValue === entityName;\n\n  return (\n    <div className=\"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-sm\">\n      <div className=\"bg-white rounded-3xl shadow-2xl w-full max-w-md overflow-hidden animate-in fade-in zoom-in duration-200\">\n        <div className=\"p-8\">\n          <div className=\"w-16 h-16 bg-red-50 text-red-600 rounded-2xl flex items-center justify-center text-3xl mb-6\">‚ö†Ô∏è</div>\n          <h3 className=\"text-2xl font-bold text-slate-900 mb-2\">Confirm Deletion</h3>\n          <p className=\"text-slate-500 mb-6 leading-relaxed\">\n            You are about to delete this <strong>{entityType}</strong>. This action is irreversible. \n            To proceed, please type the name below:\n          </p>\n          \n          <div className=\"space-y-4\">\n            <div>\n              <label className=\"block text-xs font-bold text-slate-400 uppercase mb-2\">Verify Name</label>\n              <input\n                type=\"text\"\n                autoFocus\n                value={inputValue}\n                onChange={(e) => setInputValue(e.target.value)}\n                placeholder={entityName}\n                className=\"w-full px-5 py-3 bg-slate-50 border-2 border-slate-100 rounded-xl focus:border-red-500 focus:ring-0 outline-none font-semibold transition-all\"\n              />\n            </div>\n          </div>\n        </div>\n\n        <div className=\"bg-slate-50 px-8 py-6 flex flex-col sm:flex-row-reverse gap-3\">\n          <button\n            onClick={onConfirm}\n            disabled={!isMatched}\n            className={`flex-1 px-6 py-3 rounded-xl font-bold transition-all ${\n              isMatched \n                ? 'bg-red-600 text-white shadow-lg shadow-red-200 hover:bg-red-700' \n                : 'bg-slate-200 text-slate-400 cursor-not-allowed'\n            }`}\n          >\n            Permanently Delete\n          </button>\n          <button\n            onClick={onClose}\n            className=\"flex-1 px-6 py-3 bg-white border border-slate-200 text-slate-600 rounded-xl font-bold hover:bg-slate-100 transition-all\"\n          >\n            Cancel\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default SafeDeleteModal;\n"
            }
          ]
        },
        {
          "path": "components/Layout.tsx",
          "generationType": 1,
          "isDone": true,
          "description": "Updated sidebar to dynamically include work types for employees and remove the static 'New Work Entry' tab.",
          "diffs": [
            {
              "target": "",
              "replacement": "\nimport React from 'react';\nimport { User, UserRole, WorkType } from '../types';\n\ninterface LayoutProps {\n  user: User;\n  workTypes: WorkType[];\n  onLogout: () => void;\n  children: React.ReactNode;\n  activeTab: string;\n  setActiveTab: (tab: string) => void;\n}\n\nconst Layout: React.FC<LayoutProps> = ({ user, workTypes, onLogout, children, activeTab, setActiveTab }) => {\n  const isAdmin = user.role === UserRole.ADMIN;\n\n  const menuItems = isAdmin \n    ? [\n        { id: 'dashboard', label: 'Dashboard', icon: 'üìä' },\n        { id: 'employees', label: 'Manage Employees', icon: 'üë•' },\n        { id: 'work-types', label: 'Setup Work Pages', icon: 'üõ†Ô∏è' },\n        { id: 'all-records', label: 'Office Records', icon: 'üìÅ' },\n      ]\n    : [\n        { id: 'dashboard', label: 'My Dashboard', icon: 'üè†' },\n        { id: 'my-records', label: 'My Submissions', icon: 'üìã' },\n      ];\n\n  const dynamicItems = !isAdmin ? workTypes.map(wt => ({\n    id: `work-entry-${wt.id}`,\n    label: wt.name,\n    icon: 'üìÑ'\n  })) : [];\n\n  return (\n    <div className=\"flex h-screen overflow-hidden bg-slate-50\">\n      {/* Sidebar */}\n      <aside className=\"w-64 bg-slate-900 text-white flex flex-col\">\n        <div className=\"p-6 border-b border-slate-800\">\n          <h1 className=\"text-xl font-bold tracking-tight text-indigo-400\">OfficeHub Pro</h1>\n          <p className=\"text-xs text-slate-400 mt-1 uppercase tracking-widest\">{user.role}</p>\n        </div>\n        \n        <nav className=\"flex-1 p-4 space-y-1 overflow-y-auto custom-scrollbar\">\n          {menuItems.map((item) => (\n            <button\n              key={item.id}\n              onClick={() => setActiveTab(item.id)}\n              className={`w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors ${\n                activeTab === item.id \n                  ? 'bg-indigo-600 text-white shadow-lg' \n                  : 'text-slate-400 hover:bg-slate-800 hover:text-white'\n              }`}\n            >\n              <span className=\"text-xl\">{item.icon}</span>\n              <span className=\"font-medium\">{item.label}</span>\n            </button>\n          ))}\n\n          {dynamicItems.length > 0 && (\n            <div className=\"pt-6 pb-2\">\n              <p className=\"px-4 text-[10px] font-bold text-slate-500 uppercase tracking-widest mb-2\">Work Entries</p>\n              {dynamicItems.map((item) => (\n                <button\n                  key={item.id}\n                  onClick={() => setActiveTab(item.id)}\n                  className={`w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors mb-1 ${\n                    activeTab === item.id \n                      ? 'bg-indigo-600 text-white shadow-lg' \n                      : 'text-slate-400 hover:bg-slate-800 hover:text-white'\n                  }`}\n                >\n                  <span className=\"text-xl\">{item.icon}</span>\n                  <span className=\"font-medium truncate text-sm\">{item.label}</span>\n                </button>\n              ))}\n            </div>\n          )}\n        </nav>\n\n        <div className=\"p-4 border-t border-slate-800\">\n          <div className=\"flex items-center space-x-3 px-4 py-2 mb-4\">\n            <div className=\"w-8 h-8 rounded-full bg-indigo-500 flex items-center justify-center text-xs font-bold shrink-0\">\n              {user.name.charAt(0)}\n            </div>\n            <div className=\"flex-1 overflow-hidden\">\n              <p className=\"text-sm font-medium truncate\">{user.name}</p>\n              <p className=\"text-xs text-slate-500 truncate\">{user.username}</p>\n            </div>\n          </div>\n          <button\n            onClick={onLogout}\n            className=\"w-full flex items-center justify-center space-x-2 px-4 py-2 rounded-lg bg-slate-800 hover:bg-red-900/50 hover:text-red-200 transition-all text-slate-300\"\n          >\n            <span>üö™</span>\n            <span className=\"text-sm font-semibold\">Logout</span>\n          </button>\n        </div>\n      </aside>\n\n      {/* Main Content */}\n      <main className=\"flex-1 overflow-y-auto p-8 relative\">\n        <div className=\"max-w-6xl mx-auto\">\n          {children}\n        </div>\n      </main>\n    </div>\n  );\n};\n\nexport default Layout;\n"
            }
          ]
        },
        {
          "path": "components/RecordList.tsx",
          "generationType": 1,
          "isDone": true,
          "description": "Enhanced records list for admins with editing and secure deletion capabilities.",
          "diffs": [
            {
              "target": "",
              "replacement": "\nimport React, { useState } from 'react';\nimport { WorkType, WorkRecord, User, UserRole } from '../types';\nimport SafeDeleteModal from './SafeDeleteModal';\n\ninterface Props {\n  records: WorkRecord[];\n  workTypes: WorkType[];\n  users: User[];\n  currentUser: User;\n  onUpdate: (records: WorkRecord[]) => void;\n  onEdit: (record: WorkRecord) => void;\n}\n\nconst RecordList: React.FC<Props> = ({ records, workTypes, users, currentUser, onUpdate, onEdit }) => {\n  const [filterType, setFilterType] = useState<string>('all');\n  const [deleteTarget, setDeleteTarget] = useState<WorkRecord | null>(null);\n  \n  const isAdmin = currentUser.role === UserRole.ADMIN;\n  const filteredRecords = records.filter(rec => {\n    const isOwner = isAdmin || rec.employeeId === currentUser.id;\n    const isCorrectType = filterType === 'all' || rec.workTypeId === filterType;\n    return isOwner && isCorrectType;\n  });\n\n  const getPrimaryValue = (rec: WorkRecord) => {\n    const type = workTypes.find(t => t.id === rec.workTypeId);\n    const primaryField = type?.fields.find(f => f.isPrimary) || type?.fields[0];\n    return primaryField ? rec.data[primaryField.id] : 'N/A';\n  };\n\n  const handleDeleteConfirm = () => {\n    if (deleteTarget) {\n      onUpdate(records.filter(r => r.id !== deleteTarget.id));\n      setDeleteTarget(null);\n    }\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h2 className=\"text-2xl font-bold text-slate-900\">{isAdmin ? 'All Office Records' : 'My Submissions'}</h2>\n          <p className=\"text-slate-500 text-sm\">View and manage office task history.</p>\n        </div>\n        <div className=\"flex space-x-2\">\n          <select \n            value={filterType}\n            onChange={e => setFilterType(e.target.value)}\n            className=\"bg-white px-4 py-2 border border-slate-200 rounded-xl text-sm font-medium outline-none focus:ring-2 focus:ring-indigo-500 transition-all\"\n          >\n            <option value=\"all\">All Work Categories</option>\n            {workTypes.map(wt => <option key={wt.id} value={wt.id}>{wt.name}</option>)}\n          </select>\n        </div>\n      </div>\n\n      <div className=\"bg-white rounded-3xl border border-slate-200 shadow-sm overflow-hidden\">\n        <div className=\"overflow-x-auto\">\n          <table className=\"w-full text-left\">\n            <thead className=\"bg-slate-50 border-b border-slate-200\">\n              <tr>\n                <th className=\"px-6 py-4 text-xs font-bold text-slate-400 uppercase tracking-widest\">Category</th>\n                <th className=\"px-6 py-4 text-xs font-bold text-slate-400 uppercase tracking-widest\">Record Title</th>\n                {isAdmin && <th className=\"px-6 py-4 text-xs font-bold text-slate-400 uppercase tracking-widest\">Employee</th>}\n                <th className=\"px-6 py-4 text-xs font-bold text-slate-400 uppercase tracking-widest\">Logged</th>\n                <th className=\"px-6 py-4 text-xs font-bold text-slate-400 uppercase tracking-widest text-right\">Actions</th>\n              </tr>\n            </thead>\n            <tbody className=\"divide-y divide-slate-100\">\n              {filteredRecords.length === 0 ? (\n                <tr>\n                  <td colSpan={5} className=\"px-6 py-16 text-center text-slate-400 italic\">\n                    <div className=\"text-4xl mb-4\">üìÇ</div>\n                    <p>No records found matching your criteria.</p>\n                  </td>\n                </tr>\n              ) : (\n                filteredRecords.map(rec => {\n                  const type = workTypes.find(t => t.id === rec.workTypeId);\n                  const emp = users.find(u => u.id === rec.employeeId);\n                  const primaryVal = getPrimaryValue(rec);\n                  \n                  return (\n                    <tr key={rec.id} className=\"hover:bg-slate-50/50 transition-colors group\">\n                      <td className=\"px-6 py-4\">\n                        <span className=\"px-2 py-1 bg-indigo-50 text-indigo-700 text-[10px] font-black uppercase rounded-lg border border-indigo-100\">\n                          {type?.name || 'Deleted Type'}\n                        </span>\n                      </td>\n                      <td className=\"px-6 py-4 font-bold text-slate-800\">\n                        {primaryVal}\n                      </td>\n                      {isAdmin && (\n                        <td className=\"px-6 py-4\">\n                          <div className=\"flex items-center space-x-2\">\n                            <div className=\"w-6 h-6 rounded-full bg-slate-200 flex items-center justify-center text-[10px] font-bold text-slate-600\">\n                              {emp?.name.charAt(0)}\n                            </div>\n                            <span className=\"text-sm text-slate-600 font-medium\">{emp?.name || 'Unknown'}</span>\n                          </div>\n                        </td>\n                      )}\n                      <td className=\"px-6 py-4 text-xs text-slate-400 font-medium\">\n                        {new Date(rec.createdAt).toLocaleDateString()}\n                      </td>\n                      <td className=\"px-6 py-4 text-right\">\n                        <div className=\"flex justify-end space-x-2 opacity-0 group-hover:opacity-100 transition-opacity\">\n                          {isAdmin && (\n                            <>\n                              <button \n                                onClick={() => onEdit(rec)}\n                                className=\"p-2 text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors\"\n                                title=\"Edit Record\"\n                              >\n                                ‚úèÔ∏è\n                              </button>\n                              <button \n                                onClick={() => setDeleteTarget(rec)}\n                                className=\"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors\"\n                                title=\"Delete Record\"\n                              >\n                                üóëÔ∏è\n                              </button>\n                            </>\n                          )}\n                          <button className=\"text-[10px] font-black uppercase text-slate-400 hover:text-indigo-600 px-2\">View</button>\n                        </div>\n                      </td>\n                    </tr>\n                  );\n                })\n              )}\n            </tbody>\n          </table>\n        </div>\n      </div>\n\n      {deleteTarget && (\n        <SafeDeleteModal\n          isOpen={!!deleteTarget}\n          onClose={() => setDeleteTarget(null)}\n          onConfirm={handleDeleteConfirm}\n          entityName={getPrimaryValue(deleteTarget)}\n          entityType=\"Record Entry\"\n        />\n      )}\n    </div>\n  );\n};\n\nexport default RecordList;\n"
            }
          ]
        },
        {
          "path": "components/EmployeeManager.tsx",
          "generationType": 1,
          "isDone": true,
          "description": "Integrated secure deletion modal for managing employee accounts.",
          "diffs": [
            {
              "target": "",
              "replacement": "\nimport React, { useState } from 'react';\nimport { User, UserRole } from '../types';\nimport SafeDeleteModal from './SafeDeleteModal';\n\ninterface Props {\n  users: User[];\n  onUpdate: (users: User[]) => void;\n}\n\nconst EmployeeManager: React.FC<Props> = ({ users, onUpdate }) => {\n  const [isAdding, setIsAdding] = useState(false);\n  const [editingId, setEditingId] = useState<string | null>(null);\n  const [deleteTarget, setDeleteTarget] = useState<User | null>(null);\n  const [formData, setFormData] = useState({\n    username: '',\n    password: '',\n    name: ''\n  });\n\n  const employees = users.filter(u => u.role === UserRole.EMPLOYEE);\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (editingId) {\n      const updated = users.map(u => u.id === editingId ? { ...u, ...formData } : u);\n      onUpdate(updated);\n    } else {\n      const newUser: User = {\n        id: `user-${Date.now()}`,\n        ...formData,\n        role: UserRole.EMPLOYEE,\n        createdAt: Date.now()\n      };\n      onUpdate([...users, newUser]);\n    }\n    resetForm();\n  };\n\n  const handleEdit = (user: User) => {\n    setFormData({\n      username: user.username,\n      password: user.password,\n      name: user.name\n    });\n    setEditingId(user.id);\n    setIsAdding(true);\n  };\n\n  const handleDeleteConfirm = () => {\n    if (deleteTarget) {\n      onUpdate(users.filter(u => u.id !== deleteTarget.id));\n      setDeleteTarget(null);\n    }\n  };\n\n  const resetForm = () => {\n    setFormData({ username: '', password: '', name: '' });\n    setEditingId(null);\n    setIsAdding(false);\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h2 className=\"text-2xl font-bold text-slate-900\">Employee Management</h2>\n          <p className=\"text-slate-500 text-sm\">Create and manage access for your office staff.</p>\n        </div>\n        {!isAdding && (\n          <button \n            onClick={() => setIsAdding(true)}\n            className=\"bg-indigo-600 hover:bg-indigo-700 text-white px-5 py-3 rounded-xl font-bold flex items-center space-x-2 transition-all shadow-lg shadow-indigo-100\"\n          >\n            <span>‚ûï</span>\n            <span>Add New Employee</span>\n          </button>\n        )}\n      </div>\n\n      {isAdding && (\n        <div className=\"bg-white p-8 rounded-3xl border border-slate-200 shadow-xl animate-in slide-in-from-top-4 duration-300\">\n          <div className=\"flex justify-between items-center mb-6\">\n            <h3 className=\"text-xl font-bold text-slate-800\">{editingId ? 'Edit Employee Details' : 'Create New Staff Account'}</h3>\n            <button onClick={resetForm} className=\"text-slate-400 hover:text-slate-600\">‚úï</button>\n          </div>\n          <form onSubmit={handleSubmit} className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n            <div className=\"md:col-span-1\">\n              <label className=\"block text-xs font-bold text-slate-400 mb-2 uppercase tracking-widest\">Full Name</label>\n              <input \n                required\n                value={formData.name}\n                onChange={e => setFormData({...formData, name: e.target.value})}\n                className=\"w-full px-4 py-3 bg-slate-50 border-2 border-slate-50 rounded-xl focus:border-indigo-500 focus:bg-white outline-none transition-all font-medium\"\n                placeholder=\"John Doe\"\n              />\n            </div>\n            <div>\n              <label className=\"block text-xs font-bold text-slate-400 mb-2 uppercase tracking-widest\">Username</label>\n              <input \n                required\n                value={formData.username}\n                onChange={e => setFormData({...formData, username: e.target.value})}\n                className=\"w-full px-4 py-3 bg-slate-50 border-2 border-slate-50 rounded-xl focus:border-indigo-500 focus:bg-white outline-none transition-all font-medium\"\n                placeholder=\"johndoe123\"\n              />\n            </div>\n            <div>\n              <label className=\"block text-xs font-bold text-slate-400 mb-2 uppercase tracking-widest\">Password</label>\n              <input \n                required\n                type=\"password\"\n                value={formData.password}\n                onChange={e => setFormData({...formData, password: e.target.value})}\n                className=\"w-full px-4 py-3 bg-slate-50 border-2 border-slate-50 rounded-xl focus:border-indigo-500 focus:bg-white outline-none transition-all font-medium\"\n                placeholder=\"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢\"\n              />\n            </div>\n            <div className=\"md:col-span-3 flex justify-end space-x-3 mt-4\">\n              <button \n                type=\"button\"\n                onClick={resetForm}\n                className=\"px-6 py-3 text-slate-500 hover:text-slate-700 font-bold\"\n              >\n                Cancel\n              </button>\n              <button \n                type=\"submit\"\n                className=\"bg-indigo-600 hover:bg-indigo-700 text-white px-8 py-3 rounded-xl font-bold shadow-lg shadow-indigo-100 transition-all\"\n              >\n                {editingId ? 'Update Employee' : 'Create Account'}\n              </button>\n            </div>\n          </form>\n        </div>\n      )}\n\n      <div className=\"bg-white rounded-3xl border border-slate-200 shadow-sm overflow-hidden\">\n        <table className=\"w-full text-left\">\n          <thead className=\"bg-slate-50 border-b border-slate-200\">\n            <tr>\n              <th className=\"px-6 py-4 text-xs font-bold text-slate-400 uppercase tracking-widest\">Employee</th>\n              <th className=\"px-6 py-4 text-xs font-bold text-slate-400 uppercase tracking-widest\">Login ID</th>\n              <th className=\"px-6 py-4 text-xs font-bold text-slate-400 uppercase tracking-widest\">Created</th>\n              <th className=\"px-6 py-4 text-xs font-bold text-slate-400 uppercase tracking-widest text-right\">Actions</th>\n            </tr>\n          </thead>\n          <tbody className=\"divide-y divide-slate-100\">\n            {employees.length === 0 ? (\n              <tr>\n                <td colSpan={4} className=\"px-6 py-12 text-center text-slate-400 italic\">No staff members have been added yet.</td>\n              </tr>\n            ) : (\n              employees.map(emp => (\n                <tr key={emp.id} className=\"hover:bg-slate-50/50 transition-colors group\">\n                  <td className=\"px-6 py-4\">\n                    <div className=\"flex items-center space-x-4\">\n                      <div className=\"w-10 h-10 rounded-2xl bg-indigo-50 text-indigo-600 flex items-center justify-center font-bold text-lg\">\n                        {emp.name.charAt(0)}\n                      </div>\n                      <span className=\"font-bold text-slate-800\">{emp.name}</span>\n                    </div>\n                  </td>\n                  <td className=\"px-6 py-4 text-slate-600 font-medium\">{emp.username}</td>\n                  <td className=\"px-6 py-4 text-slate-400 text-xs font-medium\">{new Date(emp.createdAt).toLocaleDateString()}</td>\n                  <td className=\"px-6 py-4 text-right\">\n                    <div className=\"flex justify-end space-x-2 opacity-0 group-hover:opacity-100 transition-all\">\n                      <button \n                        onClick={() => handleEdit(emp)}\n                        className=\"p-2 text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors\"\n                        title=\"Edit Details\"\n                      >\n                        ‚úèÔ∏è\n                      </button>\n                      <button \n                        onClick={() => setDeleteTarget(emp)}\n                        className=\"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors\"\n                        title=\"Remove Access\"\n                      >\n                        üóëÔ∏è\n                      </button>\n                    </div>\n                  </td>\n                </tr>\n              ))\n            )}\n          </tbody>\n        </table>\n      </div>\n\n      {deleteTarget && (\n        <SafeDeleteModal\n          isOpen={!!deleteTarget}\n          onClose={() => setDeleteTarget(null)}\n          onConfirm={handleDeleteConfirm}\n          entityName={deleteTarget.name}\n          entityType=\"Employee\"\n        />\n      )}\n    </div>\n  );\n};\n\nexport default EmployeeManager;\n"
            }
          ]
        },
        {
          "path": "components/WorkTypeBuilder.tsx",
          "generationType": 1,
          "isDone": true,
          "description": "Integrated secure deletion modal for managing work types and field structures.",
          "diffs": [
            {
              "target": "",
              "replacement": "\nimport React, { useState } from 'react';\nimport { WorkType, FieldDefinition, FieldType } from '../types';\nimport { suggestFieldsForWorkType } from '../geminiService';\nimport SafeDeleteModal from './SafeDeleteModal';\n\ninterface Props {\n  workTypes: WorkType[];\n  onUpdate: (types: WorkType[]) => void;\n}\n\nconst WorkTypeBuilder: React.FC<Props> = ({ workTypes, onUpdate }) => {\n  const [isCreating, setIsCreating] = useState(false);\n  const [loadingAI, setLoadingAI] = useState(false);\n  const [editingId, setEditingId] = useState<string | null>(null);\n  const [deleteTarget, setDeleteTarget] = useState<WorkType | null>(null);\n  \n  const [typeName, setTypeName] = useState('');\n  const [typeDesc, setTypeDesc] = useState('');\n  const [fields, setFields] = useState<FieldDefinition[]>([]);\n\n  const handleAddField = () => {\n    const newField: FieldDefinition = {\n      id: `field-${Date.now()}`,\n      label: '',\n      type: FieldType.TEXT,\n      required: true,\n      isExpiry: false,\n      isPrimary: fields.length === 0\n    };\n    setFields([...fields, newField]);\n  };\n\n  const handleUpdateField = (id: string, updates: Partial<FieldDefinition>) => {\n    setFields(fields.map(f => f.id === id ? { ...f, ...updates } : f));\n  };\n\n  const handleRemoveField = (id: string) => {\n    setFields(fields.filter(f => f.id !== id));\n  };\n\n  const handleAISuggest = async () => {\n    if (!typeName) return alert(\"Please enter a name first!\");\n    setLoadingAI(true);\n    const suggested = await suggestFieldsForWorkType(typeName);\n    if (suggested && suggested.length > 0) {\n      const mapped = suggested.map((s: any, idx: number) => ({\n        id: `field-ai-${idx}-${Date.now()}`,\n        label: s.label,\n        type: s.type as FieldType,\n        required: s.required,\n        isExpiry: s.isExpiry,\n        isPrimary: s.isPrimary\n      }));\n      setFields(mapped);\n    }\n    setLoadingAI(false);\n  };\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (fields.length === 0) return alert(\"Please add at least one field.\");\n\n    const newType: WorkType = {\n      id: editingId || `worktype-${Date.now()}`,\n      name: typeName,\n      description: typeDesc,\n      fields: fields,\n      createdAt: Date.now()\n    };\n\n    if (editingId) {\n      onUpdate(workTypes.map(t => t.id === editingId ? newType : t));\n    } else {\n      onUpdate([...workTypes, newType]);\n    }\n    resetForm();\n  };\n\n  const handleEdit = (type: WorkType) => {\n    setTypeName(type.name);\n    setTypeDesc(type.description);\n    setFields(type.fields);\n    setEditingId(type.id);\n    setIsCreating(true);\n  };\n\n  const handleDeleteConfirm = () => {\n    if (deleteTarget) {\n      onUpdate(workTypes.filter(t => t.id !== deleteTarget.id));\n      setDeleteTarget(null);\n    }\n  };\n\n  const resetForm = () => {\n    setTypeName('');\n    setTypeDesc('');\n    setFields([]);\n    setEditingId(null);\n    setIsCreating(false);\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h2 className=\"text-2xl font-bold text-slate-900\">Work Page Setup</h2>\n          <p className=\"text-slate-500 text-sm\">Design custom forms and data structures for office tasks.</p>\n        </div>\n        {!isCreating && (\n          <button \n            onClick={() => setIsCreating(true)}\n            className=\"bg-indigo-600 hover:bg-indigo-700 text-white px-5 py-3 rounded-xl font-bold flex items-center space-x-2 shadow-lg shadow-indigo-100 transition-all\"\n          >\n            <span>‚ú®</span>\n            <span>Create New Layout</span>\n          </button>\n        )}\n      </div>\n\n      {isCreating && (\n        <div className=\"bg-white p-8 rounded-3xl border border-slate-200 shadow-xl space-y-6 animate-in slide-in-from-top-4 duration-300\">\n          <div className=\"flex justify-between items-start\">\n            <h3 className=\"text-xl font-bold text-slate-800\">{editingId ? 'Edit Layout Structure' : 'New Dynamic Layout Builder'}</h3>\n            <button onClick={resetForm} className=\"text-slate-400 hover:text-slate-600 p-2\">‚úï</button>\n          </div>\n\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\n            <div className=\"space-y-6\">\n              <div>\n                <label className=\"block text-xs font-bold text-slate-400 uppercase tracking-widest mb-2\">Layout Name</label>\n                <div className=\"flex space-x-2\">\n                  <input \n                    required\n                    value={typeName}\n                    onChange={e => setTypeName(e.target.value)}\n                    className=\"flex-1 px-5 py-3 bg-slate-50 border-2 border-slate-50 rounded-xl focus:border-indigo-500 focus:bg-white outline-none font-bold text-lg transition-all\"\n                    placeholder=\"e.g., Professional Tax Registration\"\n                  />\n                  <button \n                    type=\"button\"\n                    onClick={handleAISuggest}\n                    disabled={loadingAI}\n                    className=\"px-4 py-2 bg-indigo-50 text-indigo-700 rounded-xl font-black text-[10px] uppercase hover:bg-indigo-100 disabled:opacity-50 flex flex-col items-center justify-center min-w-[110px]\"\n                  >\n                    {loadingAI ? 'AI thinking...' : 'ü§ñ Use Gemini AI'}\n                  </button>\n                </div>\n              </div>\n              <div>\n                <label className=\"block text-xs font-bold text-slate-400 uppercase tracking-widest mb-2\">Description</label>\n                <textarea \n                  value={typeDesc}\n                  onChange={e => setTypeDesc(e.target.value)}\n                  className=\"w-full px-5 py-3 bg-slate-50 border-2 border-slate-50 rounded-xl focus:border-indigo-500 focus:bg-white outline-none h-24 font-medium transition-all\"\n                  placeholder=\"What is this form for?\"\n                />\n              </div>\n            </div>\n\n            <div className=\"bg-slate-50 p-6 rounded-3xl border border-slate-100 overflow-y-auto max-h-[500px] shadow-inner\">\n              <div className=\"flex justify-between items-center mb-6\">\n                <h4 className=\"text-xs font-black text-slate-400 uppercase tracking-widest\">Fields & Validation</h4>\n                <button \n                  type=\"button\" \n                  onClick={handleAddField}\n                  className=\"text-[10px] font-black uppercase bg-white px-3 py-1.5 border border-slate-200 rounded-lg shadow-sm hover:border-indigo-300 transition-all\"\n                >\n                  + Manual Field\n                </button>\n              </div>\n\n              <div className=\"space-y-4\">\n                {fields.length === 0 && (\n                  <div className=\"text-center py-12 text-slate-400 text-sm italic border-2 border-dashed border-slate-200 rounded-2xl\">\n                    No fields added yet.\n                  </div>\n                )}\n                {fields.map((field, idx) => (\n                  <div key={field.id} className=\"bg-white p-5 rounded-2xl border border-slate-200 shadow-sm relative group animate-in fade-in duration-200\">\n                    <button \n                      onClick={() => handleRemoveField(field.id)}\n                      className=\"absolute top-3 right-3 text-slate-300 hover:text-red-500 transition-colors\"\n                    >\n                      ‚úï\n                    </button>\n                    <div className=\"grid grid-cols-2 gap-4 mb-4\">\n                      <div>\n                        <input \n                          value={field.label}\n                          onChange={e => handleUpdateField(field.id, { label: e.target.value })}\n                          className=\"w-full text-sm font-bold border-b-2 border-transparent focus:border-indigo-400 outline-none pb-1\"\n                          placeholder=\"Field Label\"\n                        />\n                      </div>\n                      <select \n                        value={field.type}\n                        onChange={e => handleUpdateField(field.id, { type: e.target.value as FieldType })}\n                        className=\"text-xs font-bold bg-slate-50 border-none rounded-lg outline-none cursor-pointer\"\n                      >\n                        {Object.values(FieldType).map(t => <option key={t} value={t}>{t.toUpperCase()}</option>)}\n                      </select>\n                    </div>\n                    <div className=\"flex items-center space-x-6 text-[10px] font-black text-slate-400 tracking-widest\">\n                      <label className=\"flex items-center space-x-2 cursor-pointer hover:text-slate-600 transition-colors\">\n                        <input \n                          type=\"checkbox\" \n                          checked={field.required} \n                          onChange={e => handleUpdateField(field.id, { required: e.target.checked })}\n                          className=\"w-3 h-3 rounded\"\n                        />\n                        <span>REQUIRED</span>\n                      </label>\n                      <label className=\"flex items-center space-x-2 cursor-pointer text-amber-600 hover:text-amber-700 transition-colors\">\n                        <input \n                          type=\"checkbox\" \n                          checked={field.isExpiry} \n                          onChange={e => handleUpdateField(field.id, { isExpiry: e.target.checked })}\n                          className=\"w-3 h-3 rounded\"\n                        />\n                        <span>EXPIRY TRACKER</span>\n                      </label>\n                      <label className=\"flex items-center space-x-2 cursor-pointer text-indigo-600 hover:text-indigo-700 transition-colors\">\n                        <input \n                          type=\"radio\" \n                          name=\"primary-field\"\n                          checked={field.isPrimary} \n                          onChange={() => {\n                            setFields(fields.map(f => ({ ...f, isPrimary: f.id === field.id })));\n                          }}\n                          className=\"w-3 h-3\"\n                        />\n                        <span>RECORD TITLE</span>\n                      </label>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </div>\n          </div>\n\n          <div className=\"flex justify-end space-x-4 pt-6 border-t border-slate-100\">\n            <button onClick={resetForm} className=\"px-6 py-3 font-bold text-slate-500 hover:text-slate-700\">Cancel</button>\n            <button \n              onClick={handleSubmit}\n              className=\"px-10 py-3 bg-indigo-600 hover:bg-indigo-700 text-white rounded-xl font-bold shadow-lg shadow-indigo-100 transition-all\"\n            >\n              {editingId ? 'Update Layout' : 'Publish Work Page'}\n            </button>\n          </div>\n        </div>\n      )}\n\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n        {workTypes.map(type => (\n          <div key={type.id} className=\"bg-white p-6 rounded-3xl border border-slate-200 shadow-sm hover:shadow-md transition-all group flex flex-col justify-between\">\n            <div>\n              <div className=\"flex justify-between items-start mb-4\">\n                <div className=\"w-12 h-12 bg-indigo-50 text-indigo-600 flex items-center justify-center rounded-2xl text-2xl font-bold shadow-inner\">\n                  üìÑ\n                </div>\n                <div className=\"flex space-x-1 opacity-0 group-hover:opacity-100 transition-opacity\">\n                  <button onClick={() => handleEdit(type)} className=\"p-2 hover:bg-indigo-50 rounded-lg text-indigo-600 transition-colors\">‚úèÔ∏è</button>\n                  <button onClick={() => setDeleteTarget(type)} className=\"p-2 hover:bg-red-50 rounded-lg text-red-600 transition-colors\">üóëÔ∏è</button>\n                </div>\n              </div>\n              <h3 className=\"text-xl font-bold text-slate-800\">{type.name}</h3>\n              <p className=\"text-slate-500 text-sm mt-2 line-clamp-2 h-10 font-medium leading-relaxed\">{type.description || 'Professional office service form.'}</p>\n            </div>\n            <div className=\"mt-8 pt-6 border-t border-slate-50 flex items-center justify-between\">\n              <span className=\"text-[10px] font-black text-slate-400 uppercase tracking-widest\">{type.fields.length} Active Fields</span>\n              <span className=\"text-[10px] font-bold text-slate-300\">Created {new Date(type.createdAt).toLocaleDateString()}</span>\n            </div>\n          </div>\n        ))}\n\n        {workTypes.length === 0 && !isCreating && (\n          <div className=\"col-span-full py-24 bg-slate-50 border-2 border-dashed border-slate-200 rounded-[3rem] flex flex-col items-center justify-center text-slate-400 animate-pulse\">\n            <div className=\"text-6xl mb-4 opacity-20\">üèóÔ∏è</div>\n            <p className=\"text-xl font-bold\">No custom work pages setup yet.</p>\n            <button onClick={() => setIsCreating(true)} className=\"mt-4 text-indigo-600 font-bold hover:underline decoration-2 underline-offset-8 transition-all\">Start Designing Your Office Layouts</button>\n          </div>\n        )}\n      </div>\n\n      {deleteTarget && (\n        <SafeDeleteModal\n          isOpen={!!deleteTarget}\n          onClose={() => setDeleteTarget(null)}\n          onConfirm={handleDeleteConfirm}\n          entityName={deleteTarget.name}\n          entityType=\"Work Page Structure\"\n        />\n      )}\n    </div>\n  );\n};\n\nexport default WorkTypeBuilder;\n"
            }
          ]
        },
        {
          "path": "App.tsx",
          "generationType": 1,
          "isDone": true,
          "description": "Updated state handling to support dynamic sidebar entry forms, admin record editing, and removal of static entry tab.",
          "diffs": [
            {
              "target": "",
              "replacement": "\nimport React, { useState, useEffect } from 'react';\nimport { User, UserRole, WorkType, WorkRecord } from './types';\nimport { Storage } from './storage';\nimport LoginPage from './components/LoginPage';\nimport Layout from './components/Layout';\nimport AdminDashboard from './components/AdminDashboard';\nimport EmployeeManager from './components/EmployeeManager';\nimport WorkTypeBuilder from './components/WorkTypeBuilder';\nimport EmployeeDashboard from './components/EmployeeDashboard';\nimport WorkEntryForm from './components/WorkEntryForm';\nimport RecordList from './components/RecordList';\n\nconst App: React.FC = () => {\n  const [user, setUser] = useState<User | null>(null);\n  const [activeTab, setActiveTab] = useState<string>('dashboard');\n  \n  const [users, setUsers] = useState<User[]>(Storage.getUsers());\n  const [workTypes, setWorkTypes] = useState<WorkType[]>(Storage.getWorkTypes());\n  const [records, setRecords] = useState<WorkRecord[]>(Storage.getWorkRecords());\n\n  // Handle Work Selection/Editing\n  const [selectedWorkType, setSelectedWorkType] = useState<WorkType | null>(null);\n  const [editingRecord, setEditingRecord] = useState<WorkRecord | null>(null);\n\n  useEffect(() => {\n    Storage.saveUsers(users);\n  }, [users]);\n\n  useEffect(() => {\n    Storage.saveWorkTypes(workTypes);\n  }, [workTypes]);\n\n  useEffect(() => {\n    Storage.saveWorkRecords(records);\n  }, [records]);\n\n  // Intercept tab changes for dynamic entries\n  useEffect(() => {\n    if (activeTab.startsWith('work-entry-')) {\n      const typeId = activeTab.replace('work-entry-', '');\n      const type = workTypes.find(t => t.id === typeId);\n      if (type) {\n        setSelectedWorkType(type);\n        setEditingRecord(null);\n      }\n    }\n  }, [activeTab, workTypes]);\n\n  const handleLogin = (u: User) => {\n    setUser(u);\n    setActiveTab('dashboard');\n  };\n\n  const handleLogout = () => {\n    setUser(null);\n    setSelectedWorkType(null);\n    setEditingRecord(null);\n  };\n\n  const handleNewEntryFromDashboard = (typeId: string) => {\n    setActiveTab(`work-entry-${typeId}`);\n  };\n\n  const handleAdminEditRecord = (record: WorkRecord) => {\n    const type = workTypes.find(t => t.id === record.workTypeId);\n    if (type) {\n      setEditingRecord(record);\n      setSelectedWorkType(type);\n      setActiveTab('edit-record-form');\n    }\n  };\n\n  if (!user) {\n    return <LoginPage users={users} onLogin={handleLogin} />;\n  }\n\n  const renderContent = () => {\n    if (user.role === UserRole.ADMIN) {\n      switch (activeTab) {\n        case 'dashboard':\n          return <AdminDashboard users={users} workTypes={workTypes} records={records} />;\n        case 'employees':\n          return <EmployeeManager users={users} onUpdate={setUsers} />;\n        case 'work-types':\n          return <WorkTypeBuilder workTypes={workTypes} onUpdate={setWorkTypes} />;\n        case 'all-records':\n          return (\n            <RecordList \n              records={records} \n              workTypes={workTypes} \n              users={users} \n              currentUser={user} \n              onUpdate={setRecords}\n              onEdit={handleAdminEditRecord}\n            />\n          );\n        case 'edit-record-form':\n          if (!selectedWorkType || !editingRecord) {\n            setActiveTab('all-records');\n            return null;\n          }\n          return (\n            <WorkEntryForm \n              workType={selectedWorkType} \n              user={user} \n              initialData={editingRecord.data}\n              onSave={(recData) => {\n                const updatedRecords = records.map(r => \n                  r.id === editingRecord.id \n                    ? { ...r, data: recData, lastUpdated: Date.now() } \n                    : r\n                );\n                setRecords(updatedRecords);\n                setActiveTab('all-records');\n                setSelectedWorkType(null);\n                setEditingRecord(null);\n              }}\n              onCancel={() => {\n                setActiveTab('all-records');\n                setSelectedWorkType(null);\n                setEditingRecord(null);\n              }}\n            />\n          );\n        default:\n          return <AdminDashboard users={users} workTypes={workTypes} records={records} />;\n      }\n    } else {\n      // Employee Logic\n      if (activeTab.startsWith('work-entry-') && selectedWorkType) {\n        return (\n          <WorkEntryForm \n            workType={selectedWorkType} \n            user={user} \n            onSave={(recData) => {\n              const newRec: WorkRecord = {\n                id: `record-${Date.now()}`,\n                workTypeId: selectedWorkType.id,\n                employeeId: user.id,\n                data: recData,\n                createdAt: Date.now(),\n                lastUpdated: Date.now()\n              };\n              setRecords([newRec, ...records]);\n              setActiveTab('my-records');\n              setSelectedWorkType(null);\n            }}\n            onCancel={() => {\n              setActiveTab('dashboard');\n              setSelectedWorkType(null);\n            }}\n          />\n        );\n      }\n\n      switch (activeTab) {\n        case 'dashboard':\n          return (\n            <EmployeeDashboard \n              user={user} \n              workTypes={workTypes} \n              records={records} \n              onNewEntry={handleNewEntryFromDashboard} \n            />\n          );\n        case 'my-records':\n          return (\n            <RecordList \n              records={records} \n              workTypes={workTypes} \n              users={users} \n              currentUser={user} \n              onUpdate={setRecords}\n              onEdit={() => {}} // Employees can't edit from here\n            />\n          );\n        default:\n          return <EmployeeDashboard user={user} workTypes={workTypes} records={records} onNewEntry={handleNewEntryFromDashboard} />;\n      }\n    }\n  };\n\n  return (\n    <Layout \n      user={user} \n      workTypes={workTypes}\n      onLogout={handleLogout} \n      activeTab={activeTab} \n      setActiveTab={setActiveTab}\n    >\n      {renderContent()}\n    </Layout>\n  );\n};\n\nexport default App;\n"
            }
          ]
        },
        {
          "path": "components/WorkEntryForm.tsx",
          "generationType": 1,
          "isDone": true,
          "description": "Updated dynamic entry form to support initial data for editing by admins.",
          "diffs": [
            {
              "target": "",
              "replacement": "\nimport React, { useState, useEffect } from 'react';\nimport { WorkType, WorkRecord, User, FieldType } from '../types';\n\ninterface Props {\n  workType: WorkType;\n  user: User;\n  initialData?: Record<string, any>;\n  onSave: (data: Record<string, any>) => void;\n  onCancel: () => void;\n}\n\nconst WorkEntryForm: React.FC<Props> = ({ workType, user, initialData, onSave, onCancel }) => {\n  const [formData, setFormData] = useState<Record<string, any>>(initialData || {});\n\n  // Reset form when workType or initialData changes\n  useEffect(() => {\n    setFormData(initialData || {});\n  }, [workType.id, initialData]);\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    onSave(formData);\n  };\n\n  const handleFieldChange = (fieldId: string, value: any) => {\n    setFormData(prev => ({ ...prev, [fieldId]: value }));\n  };\n\n  return (\n    <div className=\"bg-white rounded-[2.5rem] border border-slate-200 shadow-2xl overflow-hidden animate-in fade-in zoom-in-95 duration-300\">\n      <div className=\"p-10 border-b border-slate-100 bg-slate-50/80\">\n        <div className=\"flex justify-between items-start\">\n          <div>\n            <span className=\"text-[10px] font-black uppercase tracking-[0.2em] text-indigo-500 mb-2 block\">Service Submission Form</span>\n            <h2 className=\"text-3xl font-black text-slate-900 tracking-tight\">{workType.name}</h2>\n            <p className=\"text-slate-500 mt-2 font-medium max-w-2xl\">{workType.description || 'Fill out the details below to log this office activity.'}</p>\n          </div>\n          <div className=\"text-right\">\n             <span className=\"text-xs font-bold text-slate-400\">Logger: {user.name}</span>\n          </div>\n        </div>\n      </div>\n\n      <form onSubmit={handleSubmit} className=\"p-10 space-y-8\">\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-x-12 gap-y-8\">\n          {workType.fields.map(field => (\n            <div key={field.id} className={field.type === FieldType.CHECKBOX ? 'flex items-center space-x-4 pt-4' : 'space-y-2'}>\n              {field.type !== FieldType.CHECKBOX && (\n                <label className=\"block text-xs font-black text-slate-500 uppercase tracking-widest\">\n                  {field.label}\n                  {field.required && <span className=\"text-red-500 ml-1\">*</span>}\n                  {field.isExpiry && <span className=\"ml-2 text-[10px] bg-amber-100 text-amber-700 px-2 py-0.5 rounded-full font-black\">EXPIRY TRACK</span>}\n                </label>\n              )}\n\n              {field.type === FieldType.TEXT && (\n                <input \n                  required={field.required}\n                  type=\"text\"\n                  value={formData[field.id] || ''}\n                  onChange={e => handleFieldChange(field.id, e.target.value)}\n                  className=\"w-full px-5 py-4 bg-slate-50 border-2 border-slate-50 rounded-2xl focus:border-indigo-500 focus:bg-white outline-none font-bold transition-all shadow-sm\"\n                  placeholder={`Enter ${field.label.toLowerCase()}...`}\n                />\n              )}\n\n              {field.type === FieldType.NUMBER && (\n                <input \n                  required={field.required}\n                  type=\"number\"\n                  value={formData[field.id] || ''}\n                  onChange={e => handleFieldChange(field.id, e.target.value)}\n                  className=\"w-full px-5 py-4 bg-slate-50 border-2 border-slate-50 rounded-2xl focus:border-indigo-500 focus:bg-white outline-none font-bold transition-all shadow-sm\"\n                />\n              )}\n\n              {field.type === FieldType.DATE && (\n                <input \n                  required={field.required}\n                  type=\"date\"\n                  value={formData[field.id] || ''}\n                  onChange={e => handleFieldChange(field.id, e.target.value)}\n                  className=\"w-full px-5 py-4 bg-slate-50 border-2 border-slate-50 rounded-2xl focus:border-indigo-500 focus:bg-white outline-none font-bold transition-all shadow-sm\"\n                />\n              )}\n\n              {field.type === FieldType.SELECT && (\n                <select \n                  required={field.required}\n                  value={formData[field.id] || ''}\n                  onChange={e => handleFieldChange(field.id, e.target.value)}\n                  className=\"w-full px-5 py-4 bg-slate-50 border-2 border-slate-50 rounded-2xl focus:border-indigo-500 focus:bg-white outline-none font-bold transition-all shadow-sm cursor-pointer appearance-none\"\n                >\n                  <option value=\"\">Select an option</option>\n                  {field.options?.map(opt => <option key={opt} value={opt}>{opt}</option>)}\n                </select>\n              )}\n\n              {field.type === FieldType.CHECKBOX && (\n                <>\n                  <div className=\"relative inline-flex items-center cursor-pointer\">\n                    <input \n                      type=\"checkbox\"\n                      checked={formData[field.id] || false}\n                      onChange={e => handleFieldChange(field.id, e.target.checked)}\n                      className=\"w-6 h-6 rounded-lg text-indigo-600 border-2 border-slate-200 focus:ring-indigo-500 transition-all cursor-pointer\"\n                    />\n                  </div>\n                  <label className=\"text-sm font-bold text-slate-700 cursor-pointer\">{field.label}</label>\n                </>\n              )}\n            </div>\n          ))}\n        </div>\n\n        <div className=\"flex justify-end space-x-6 pt-10 mt-6 border-t border-slate-100\">\n          <button \n            type=\"button\" \n            onClick={onCancel}\n            className=\"px-8 py-4 font-bold text-slate-400 hover:text-slate-700 transition-all uppercase tracking-widest text-xs\"\n          >\n            Cancel Entry\n          </button>\n          <button \n            type=\"submit\"\n            className=\"px-14 py-4 bg-indigo-600 hover:bg-indigo-700 text-white rounded-2xl font-black shadow-xl shadow-indigo-100 transition-all active:scale-95 uppercase tracking-widest text-xs\"\n          >\n            {initialData ? 'Apply Changes' : 'Submit Final Entry'}\n          </button>\n        </div>\n      </form>\n    </div>\n  );\n};\n\nexport default WorkEntryForm;\n"
            }
          ]
        }
      ]
    },
    "createdTimestamp": {
      "seconds": 1771083865,
      "nanos": 328000000
    },
    "doneTimestamp": {
      "seconds": 1771083869,
      "nanos": 675000000
    }
  }
]